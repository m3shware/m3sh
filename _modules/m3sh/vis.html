

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>m3sh.vis &mdash; m3sh 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="../../_static/ghems_red.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            m3sh
              <img src="../../_static/logo-small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
   
              <p class="caption" role="heading"><span class="caption-text">Basic usage and examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../basics.html">Mesh basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iterators.html">Neighborhood traversal</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules - API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mesh.html">Halfedge data structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../helper.html">Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vis.html">Visualization</a></li>
</ul>

   <p class="caption">
     <span class="caption-text">Indices</span>
   </p>
   <ul>
        <li class="toctree-l1"><a href= "../../genindex.html">Index</a></li>
        <li class="toctree-l1"><a href= "../../py-modindex.html">Module index</a></li>
        <li class="toctree-l1"><a href= "https://github.com/m3shware/m3sh">Package source</a></li>
   </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">m3sh</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">m3sh.vis</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for m3sh.vis</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2024, m3shware</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c1"># in the Software without restriction, including without limitation the rights</span>
<span class="c1"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c1"># copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in</span>
<span class="c1"># all copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="c1"># SOFTWARE.</span>

<span class="sd">&quot;&quot;&quot; Visualization using VTK.</span>

<span class="sd">Wrapper functions for `VTK &lt;https://vtk.org/doc/nightly/html&gt;`_ functionality.</span>
<span class="sd">This is not meant as a full featured set of visualization routines but should</span>
<span class="sd">serve as a quick and convenient way to achieve basic visualization tasks.</span>

<span class="sd">This module can also be used as a stand-alone OBJ viewer:</span>

<span class="sd">&gt;&gt;&gt; python vis.py file.obj --edges</span>

<span class="sd">opens a graphics window and displays the contents of `file.obj`. Omitting</span>
<span class="sd">the &#39;--edges&#39; argument will not render mesh edges.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">vtk</span>

<span class="kn">from</span> <span class="nn">vtk.util</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span> <span class="nn">vtk.util.numpy_support</span> <span class="kn">import</span> <span class="n">numpy_to_vtk</span>
<span class="kn">from</span> <span class="nn">vtk.util.numpy_support</span> <span class="kn">import</span> <span class="n">vtk_to_numpy</span>


<span class="c1"># Main render window. Always created show(). Windows created by window()</span>
<span class="c1"># are considered secondary windows. They are closed once the main window</span>
<span class="c1"># is closed.</span>
<span class="n">_renwin</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># The current render of the main window. This is either the last render</span>
<span class="c1"># created or set as current via canvas().</span>
<span class="n">_renderer</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Overlay viewport of the main window. Renderer on layer 1, transparent</span>
<span class="c1"># background by default. All other renderers at on layer 0 and opaque.</span>
<span class="c1"># This render is created and removed on demand (default key &#39;h&#39; for help).</span>
<span class="n">_splash</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># All renderers of the main window. Does not include renderers of secondary</span>
<span class="c1"># windows which are currently limited to a single renderer on layer 0.</span>
<span class="n">_renderers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># All render window interactors including the interactors of secondary</span>
<span class="c1"># windows.</span>
<span class="n">_interactors</span> <span class="o">=</span> <span class="p">[]</span>


<div class="viewcode-block" id="canvas">
<a class="viewcode-back" href="../../api/m3sh.vis.canvas.html#m3sh.vis.canvas">[docs]</a>
<span class="k">def</span> <span class="nf">canvas</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">interactive</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot; Create or modify viewport.</span>

<span class="sd">    Change properties of an existing viewport or create a new one inside</span>
<span class="sd">    the main render window. A viewport&#39;s size and position is defined</span>
<span class="sd">    relative to the size of the render window in normalized coordinates.</span>

<span class="sd">    The variable length argument list `*args` may hold 0 (to create new</span>
<span class="sd">    viewport), 1 (to make `renderer` current), 4 (to set viewport dimensions)</span>
<span class="sd">    or 5 values as documented below.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    renderer : vtkRenderer, optional</span>
<span class="sd">        Viewport identifier.</span>
<span class="sd">    xmin : float, optional</span>
<span class="sd">        Smaller x-coordinate of the viewport.</span>
<span class="sd">    xmax : float, optional</span>
<span class="sd">        Larger x-coordinate of the viewport.</span>
<span class="sd">    ymin : float, optional</span>
<span class="sd">        Smaller y-coordinate of the viewport.</span>
<span class="sd">    ymax : float, optional</span>
<span class="sd">        Larger y-coordinate of the viewport.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkRenderer</span>
<span class="sd">        Active viewport. All subsequent plotting happen in this viewport.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Passing a renderer as first positional argument makes it the current</span>
<span class="sd">    viewport. All :obj:`None` keyword arguments do not modify the</span>
<span class="sd">    corresponding property of the current viewport.</span>

<span class="sd">    Keyword Arguments</span>
<span class="sd">    -----------------</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Background color.</span>
<span class="sd">    color2 : array_like, shape (3, ), optional</span>
<span class="sd">        Top background color.</span>
<span class="sd">    camera : vtkRenderer or vtkCamera, optional</span>
<span class="sd">        Shared camera.</span>
<span class="sd">    transparent : bool, optional</span>
<span class="sd">        Toggle transparent background.</span>
<span class="sd">    interactive : bool, optional</span>
<span class="sd">        Toggle event notification.</span>
<span class="sd">    layer : int, optional</span>
<span class="sd">        Layer index. Only for internal use.</span>
<span class="sd">    shadows : bool, optional</span>
<span class="sd">        Render shadows, experimental.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Setting `interactive` to :obj:`False` will prevent a viewport from</span>
<span class="sd">    receiving events. Note that widgets placed in such a non-interactive</span>
<span class="sd">    renderer still receive interaction events.</span>

<span class="sd">    Warning</span>
<span class="sd">    -------</span>
<span class="sd">    Shadows are not computed correctly in non-square viewports! This is</span>
<span class="sd">    a known VTK bug.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The active renderer is a global state variable that is modified</span>
    <span class="c1"># inside this function.</span>
    <span class="k">global</span> <span class="n">_renderer</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="c1"># A renderer is given. Change its properties if they are given.</span>
        <span class="c1"># The passed renderer also becomes the active renderer.</span>
        <span class="n">_renderer</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Remove the viewport argument from the argument list for easy</span>
        <span class="c1"># access of the vieport dimension parameters.</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="c1"># No renderer is given. Create a new one and set its properties</span>
        <span class="c1"># to the given values or global defaults. The renderer becomes</span>
        <span class="c1"># the active renderer.</span>
        <span class="n">_renderer</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderer</span><span class="p">()</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetUseDepthPeeling</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetOcclusionRatio</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetMaximumNumberOfPeels</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetUseFXAA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">lightkit</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLightKit</span><span class="p">()</span>
        <span class="n">lightkit</span><span class="o">.</span><span class="n">AddLightsToRenderer</span><span class="p">(</span><span class="n">_renderer</span><span class="p">)</span>

        <span class="c1"># Add the new renderer to the list of all renderers of the main</span>
        <span class="c1"># render window. Otherwise the generated list is consumed when</span>
        <span class="c1"># the main window instance is created in show().</span>
        <span class="k">if</span> <span class="n">_renwin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_renwin</span><span class="o">.</span><span class="n">AddRenderer</span><span class="p">(</span><span class="n">_renderer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_renderers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_renderer</span><span class="p">)</span>

        <span class="c1"># Default camera orientation. Overwritten later if the camera</span>
        <span class="c1"># argument is given.</span>
        <span class="n">cam</span> <span class="o">=</span> <span class="n">_renderer</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">()</span>
        <span class="n">cam</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
        <span class="n">cam</span><span class="o">.</span><span class="n">SetViewUp</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="c1"># Assign default color for new renderers if no color is given.</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_renderer</span><span class="o">.</span><span class="n">SetBackground</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;wrong number of positional arguments&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetViewport</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>         <span class="c1"># lower left</span>
                              <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>         <span class="c1"># upper right</span>

    <span class="k">if</span> <span class="n">camera</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Set the provided camera. Either directly or use the camera of</span>
        <span class="c1"># another renderer. The latter case will sync the viewports.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderer</span><span class="p">):</span>
            <span class="n">camera</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">()</span>

        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetActiveCamera</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetBackground</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">transparent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetPreserveColorBuffer</span><span class="p">(</span><span class="n">transparent</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">interactive</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetInteractive</span><span class="p">(</span><span class="n">interactive</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">shadows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Note that shadows are wrong when rendering to non-square</span>
        <span class="c1"># windows (known bug).</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetUseShadows</span><span class="p">(</span><span class="n">shadows</span><span class="p">)</span>

    <span class="c1"># Viewports can be layered, i.e., occupy the same region in a render</span>
    <span class="c1"># window or overlap partially. In this case it can be useful to set</span>
    <span class="c1"># all viewports except for the bottom one as transparent (this is</span>
    <span class="c1"># VTK&#39;s default behavior when using the `layer` argument).</span>
    <span class="k">if</span> <span class="n">layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># The render window to which this renderer belongs needs to</span>
        <span class="c1"># support multiple layers for this to work, see show() and the</span>
        <span class="c1"># method SetNumberOfLayers() of a render window.</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetLayer</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

    <span class="c1"># A None value will not touch values for the top background color</span>
    <span class="c1"># and gradient background setting. A False value disables gradient</span>
    <span class="c1"># background for this renderer.</span>
    <span class="k">if</span> <span class="n">color2</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetGradientBackground</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">color2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetBackground2</span><span class="p">(</span><span class="n">color2</span><span class="p">)</span>
        <span class="n">_renderer</span><span class="o">.</span><span class="n">SetGradientBackground</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_renderer</span></div>



<span class="k">def</span> <span class="nf">_window</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">white</span><span class="p">,</span>
           <span class="n">color2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Create render window (experimental).</span>

<span class="sd">    Create a secondary window. Secondary windows are limited to a single</span>
<span class="sd">    viewport whose properties are set during window creation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    width : int, optional</span>
<span class="sd">        Window width in pixels.</span>
<span class="sd">    height : int, optional</span>
<span class="sd">        Window height in pixels.</span>
<span class="sd">    title : str, optional</span>
<span class="sd">        Window title.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Window background color.</span>
<span class="sd">    color2 : array_like, shape (3, ), optional</span>
<span class="sd">        Top background color for gradient background.</span>
<span class="sd">    camera : vtkRenderer or vtkCamera, optional</span>
<span class="sd">        Useful to sync the view of different renderers.</span>
<span class="sd">    interactive : bool, optional</span>
<span class="sd">        Toggle event notification for the window&#39;s viewport.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkRenderWindow</span>
<span class="sd">        The newly created render window.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Using secondary windows can cause segmentation faults depending on the</span>
<span class="sd">    used operating system and VTK version. Additionally secondary windows</span>
<span class="sd">    have to be closed using the keyboard shortcut &#39;x&#39; instead of the close</span>
<span class="sd">    button.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create viewport that spans the entire render window. Windows created</span>
    <span class="c1"># by this function are limited to one renderer. Such renderers do not</span>
    <span class="c1"># go to the list _renderers of all renderers.</span>
    <span class="n">ren</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderer</span><span class="p">()</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">SetUseDepthPeeling</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">SetOcclusionRatio</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">SetMaximumNumberOfPeels</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">SetUseFXAA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Apply user defined customization to the look and feel of the window.</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">SetBackground</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">SetInteractive</span><span class="p">(</span><span class="n">interactive</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">color2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ren</span><span class="o">.</span><span class="n">SetBackground2</span><span class="p">(</span><span class="n">color2</span><span class="p">)</span>
        <span class="n">ren</span><span class="o">.</span><span class="n">SetGradientBackground</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">camera</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Set the provided camera. Either directly or use the camera</span>
        <span class="c1"># of another renderer. The latter case will sync the viewports.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderer</span><span class="p">):</span>
            <span class="n">camera</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">()</span>

        <span class="n">ren</span><span class="o">.</span><span class="n">SetActiveCamera</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Change the camera position. It will still look at the origin</span>
        <span class="c1"># of the world coordinate system.</span>
        <span class="n">cam</span> <span class="o">=</span> <span class="n">ren</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">()</span>
        <span class="n">cam</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
        <span class="n">cam</span><span class="o">.</span><span class="n">SetViewUp</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># Create a window, set its size and title. Multisampling is turned</span>
    <span class="c1"># off because of transparent objects.</span>
    <span class="n">renwin</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindow</span><span class="p">()</span>
    <span class="n">renwin</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
    <span class="n">renwin</span><span class="o">.</span><span class="n">SetWindowName</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
    <span class="n">renwin</span><span class="o">.</span><span class="n">SetMultiSamples</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">renwin</span><span class="o">.</span><span class="n">SetAlphaBitPlanes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">renwin</span><span class="o">.</span><span class="n">AddRenderer</span><span class="p">(</span><span class="n">ren</span><span class="p">)</span>

    <span class="c1"># Seems to be too early to call this method. Results in segmentation</span>
    <span class="c1"># faults on some VTK implementations.</span>
    <span class="c1"># renwin.Render()</span>

    <span class="n">iren</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindowInteractor</span><span class="p">()</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">SetRenderWindow</span><span class="p">(</span><span class="n">renwin</span><span class="p">)</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">SetInteractorStyle</span><span class="p">(</span><span class="n">_MouseInteractorStyle</span><span class="p">())</span>

    <span class="c1"># Apparently this should be the last call when creating a new window.</span>
    <span class="c1"># iren.Initialize()</span>

    <span class="c1"># Add to the list of all interactors. This interactors will never</span>
    <span class="c1"># control the main render window.</span>
    <span class="n">_interactors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iren</span><span class="p">)</span>

    <span class="c1"># Calling this method later does not place the axes_widget at the</span>
    <span class="c1"># correct spot.</span>
    <span class="n">renwin</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>

    <span class="c1"># Set application window taskbar and dock icon.</span>
    <span class="n">_app_icon</span><span class="p">(</span><span class="n">renwin</span><span class="p">)</span>

    <span class="c1"># Camera orientation widget was introduced in VTK 9.1, alterantively</span>
    <span class="c1"># we can show an axis widget.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkVersion</span><span class="o">.</span><span class="n">GetVTKMajorVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">8</span>
            <span class="ow">and</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkVersion</span><span class="o">.</span><span class="n">GetVTKMinorVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># A reference to the widget has to be maintained to prevent it</span>
        <span class="c1"># from being garbage collected immediately.</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCameraOrientationWidget</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetParentRenderer</span><span class="p">(</span><span class="n">ren</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">GetRepresentation</span><span class="p">()</span><span class="o">.</span><span class="n">SetPadding</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SquareResize</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Axes display in the lower left corner of each viewport. Only</span>
        <span class="c1"># shown in the active viewport, i.e., the one with mouse focus.</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOrientationMarkerWidget</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetOrientationMarker</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkAxesActor</span><span class="p">())</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetCurrentRenderer</span><span class="p">(</span><span class="n">ren</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetInteractor</span><span class="p">(</span><span class="n">iren</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetViewport</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetSizeConstraintDimensionSizes</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="c1"># iren.axes_widget.SetShouldConstrainSize(True)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetInteractive</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Initialize the render window interactor. Appears that only one</span>
    <span class="c1"># interactor has to be initialized/started?!</span>
    <span class="c1"># iren.Initialize()</span>

    <span class="k">return</span> <span class="n">renwin</span>


<div class="viewcode-block" id="add">
<a class="viewcode-back" href="../../api/m3sh.vis.add.html#m3sh.vis.add">[docs]</a>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Queue object for display.</span>

<span class="sd">    The `renderer` argument should be a value returned by :func:`canvas`</span>
<span class="sd">    or a window instance returned by :func:`window`. If not specified,</span>
<span class="sd">    the current viewport is used or a new one is created if this is the</span>
<span class="sd">    first object to be displayed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : Prop or vtkActor</span>
<span class="sd">        Instance of a render object.</span>
<span class="sd">    renderer : vtkRenderer or vtkRenderWindow, optional</span>
<span class="sd">        The viewport or window to display the object.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkRenderer</span>
<span class="sd">        The renderer instance used for display.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    It is almost never necessary to use this function directly. It is</span>
<span class="sd">    used by all drawing and plotting commands automatically.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindow</span><span class="p">):</span>
            <span class="c1"># It is assumed that this window was created by window().</span>
            <span class="c1"># The actor get placed on its unique renderer.</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">GetRenderers</span><span class="p">()</span><span class="o">.</span><span class="n">GetFirstRenderer</span><span class="p">()</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderer</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># No renderer is given. Either create a new one or use the current</span>
        <span class="c1"># renderer if there is one.</span>
        <span class="k">if</span> <span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Create initial renderer. Sets the global _renderer variable</span>
            <span class="c1"># and caches the renderer to be processed by show() later.</span>
            <span class="n">canvas</span><span class="p">()</span>

        <span class="c1"># The global _renderer variable has been updated by canvas() and</span>
        <span class="c1"># no longer holds a None value.</span>
        <span class="n">renderer</span> <span class="o">=</span> <span class="n">_renderer</span>

    <span class="c1"># Get the wrapped vtkProp instance. This is the most general object</span>
    <span class="c1"># type that can be added to the scene.</span>
    <span class="n">prop</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">prop</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Prop</span><span class="p">)</span> <span class="k">else</span> <span class="n">obj</span>
    <span class="n">renderer</span><span class="o">.</span><span class="n">AddViewProp</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">renderer</span></div>



<div class="viewcode-block" id="aabb">
<a class="viewcode-back" href="../../api/m3sh.vis.aabb.html#m3sh.vis.aabb">[docs]</a>
<span class="k">def</span> <span class="nf">aabb</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="s1">&#39;dim&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">snow</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot; Axis aligned bounding box.</span>

<span class="sd">    Display axis aligned bounding box of `points` with annotation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : Prop or array_like, shape (3, k)</span>
<span class="sd">        An array of :math:`k` points in 3-space.</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Opacity of bounding box.</span>
<span class="sd">    edges : bool, optional</span>
<span class="sd">        Toggle edges of the bounding box.</span>
<span class="sd">    labels : str, optional</span>
<span class="sd">        Either :obj:`None`, &#39;dim&#39;, &#39;minmax&#39;, or &#39;both&#39;.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Bounding box color.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PolyMesh</span>
<span class="sd">        Bounding box shape.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Visual properties of the bounding box edges can be further customized</span>
<span class="sd">    via the returned :class:`PolyMesh` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">Prop</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">bounds</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;both&#39;</span> <span class="ow">or</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;minmax&#39;</span><span class="p">:</span>
        <span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">label</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;both&#39;</span> <span class="ow">or</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;dim&#39;</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.075</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span> <span class="o">=</span> <span class="n">b</span><span class="o">-</span><span class="n">a</span>

        <span class="n">_put</span><span class="p">([</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">dx</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dx</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;-x&#39;</span><span class="p">)</span>
        <span class="n">_put</span><span class="p">([</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">dy</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dy</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">_put</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">dz</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dz</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>

    <span class="n">cube</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCubeSource</span><span class="p">()</span>
    <span class="n">cube</span><span class="o">.</span><span class="n">SetBounds</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                   <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">cube</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">box</span> <span class="o">=</span> <span class="n">PolyMesh</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
    <span class="n">box</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
    <span class="n">box</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="n">opacity</span>

    <span class="k">if</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">box</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">ivory_black</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">box</span></div>



<div class="viewcode-block" id="delete">
<a class="viewcode-back" href="../../api/m3sh.vis.delete.html#m3sh.vis.delete">[docs]</a>
<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="o">*</span><span class="n">actors</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Remove actor(s).</span>

<span class="sd">    Search all defined viewports and remove the given actor(s).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *actors</span>
<span class="sd">        Sequence of actors to be removed.</span>
<span class="sd">    renderer : vtkRenderer, optional</span>
<span class="sd">        Remove actors only from this renderer.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    This will prevent an object from being displayed. As long as there are</span>
<span class="sd">    other references to it, it will not be removed from memory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">iren</span> <span class="ow">in</span> <span class="n">_interactors</span><span class="p">:</span>
            <span class="n">renwin</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetRenderWindow</span><span class="p">()</span>
            <span class="n">renderers</span> <span class="o">=</span> <span class="n">renwin</span><span class="o">.</span><span class="n">GetRenderers</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">renderer</span> <span class="ow">in</span> <span class="n">renderers</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="n">actors</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actor</span><span class="p">,</span> <span class="n">Prop</span><span class="p">):</span>
                        <span class="n">actor</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">prop</span>

                    <span class="n">renderer</span><span class="o">.</span><span class="n">RemoveViewProp</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="n">actors</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actor</span><span class="p">,</span> <span class="n">Prop</span><span class="p">):</span>
                <span class="n">actor</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">prop</span>

            <span class="n">renderer</span><span class="o">.</span><span class="n">RemoveViewProp</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span></div>



<div class="viewcode-block" id="update">
<a class="viewcode-back" href="../../api/m3sh.vis.update.html#m3sh.vis.update">[docs]</a>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Update viewports.</span>

<span class="sd">    Some changes to actors require an explicit re-render requests. Use this</span>
<span class="sd">    function if your changes are not diplayed properly. Changes applied</span>
<span class="sd">    to external data structures that are sourced by VTK objects have to be</span>
<span class="sd">    communicated by invoking the corresponding :meth:`modified` method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Variable length argument list.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Dictionary of keyword arguments.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    This functions defines arguments (which are ignored) to make it directly</span>
<span class="sd">    usable as a callback function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calling update() before a render window is created results in an</span>
    <span class="c1"># exception. Since a forced update is pointless in this situation, we</span>
    <span class="c1"># can safely ignore this problem.</span>
    <span class="k">for</span> <span class="n">iren</span> <span class="ow">in</span> <span class="n">_interactors</span><span class="p">:</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span></div>



<div class="viewcode-block" id="screenshot">
<a class="viewcode-back" href="../../api/m3sh.vis.screenshot.html#m3sh.vis.screenshot">[docs]</a>
<span class="k">def</span> <span class="nf">screenshot</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Save the current framebuffer contents.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        Name of PNG target file.</span>
<span class="sd">    scale : float, optional</span>
<span class="sd">        Scale factor.</span>
<span class="sd">    window : vtkRenderWindow, optional</span>
<span class="sd">        Window to grab.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Some display properties (for example the width of mesh edges) are given</span>
<span class="sd">    in screen units (i.e., pixels). This may give some unexpected results when</span>
<span class="sd">    using the `scale` argument to change the resolution of the saved image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">_renwin</span> <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">window</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">GetSize</span><span class="p">()</span>

    <span class="nb">filter</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkResizingWindowToImageFilter</span><span class="p">()</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">SetInputBufferTypeToRGBA</span><span class="p">()</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">scale</span><span class="o">*</span><span class="n">width</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">scale</span><span class="o">*</span><span class="n">height</span><span class="p">))</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">writer</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPNGWriter</span><span class="p">()</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">SetFileName</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="nb">filter</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>



<span class="k">def</span> <span class="nf">_test</span><span class="p">():</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>
    <span class="n">size</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">color3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="c1"># color3 = np.zeros((n, 3))</span>
    <span class="c1"># color3[:, 0] = 1.0</span>

    <span class="c1"># glyphs = scatter(points, size=0.5, color=colors.cornflower)</span>
    <span class="c1"># glyphs.colorize(color)</span>
    <span class="c1"># glyphs.opacity = 0.5</span>

    <span class="n">glyphs</span> <span class="o">=</span> <span class="n">splat</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">glyphs</span><span class="o">.</span><span class="n">colorize</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">glyphs</span><span class="o">.</span><span class="n">lookuptable</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">color</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">color</span><span class="p">)))</span>
    <span class="c1"># glyphs.scale(color)</span>

    <span class="n">colorbar</span><span class="p">(</span><span class="n">glyphs</span><span class="p">)</span>
    <span class="n">aabb</span><span class="p">(</span><span class="n">glyphs</span><span class="p">)</span>

    <span class="c1"># points = np.array([[0., 0., 0.],</span>
    <span class="c1">#                    [1., 0., 0.],</span>
    <span class="c1">#                    [2., 0., 0.]])</span>

    <span class="c1"># vectors = np.array([[0., 0., 1.],</span>
    <span class="c1">#                     [0., 0., 1.],</span>
    <span class="c1">#                     [0., 0., 1.]])</span>

    <span class="c1"># angles = np.array([0.4 * np.pi, 0.25 * np.pi, 0.1 * np.pi])</span>
    <span class="c1"># height = np.array([0.1, 0.1, 0.1])</span>

    <span class="c1"># glyph = cones(points, vectors, angles, radius=radius, double=True)</span>
    <span class="c1"># glyph.colorize(angles)</span>

    <span class="c1"># colorbar(glyph)</span>
    <span class="c1"># aabb(glyph)</span>

    <span class="n">show</span><span class="p">()</span>


<div class="viewcode-block" id="colorbar">
<a class="viewcode-back" href="../../api/m3sh.vis.colorbar.html#m3sh.vis.colorbar">[docs]</a>
<span class="k">def</span> <span class="nf">colorbar</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Display colorbar.</span>

<span class="sd">    Display visual representation of the lookup table associated with</span>
<span class="sd">    `object`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    object : Prop or vtkActor</span>
<span class="sd">        A render object.</span>
<span class="sd">    x : float, optional</span>
<span class="sd">        Horizontal position in normalized window coordinates.</span>
<span class="sd">    y : float, optional</span>
<span class="sd">        Vertical position in normalized window coordinates.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LookupTable</span>
<span class="sd">        Visual representation of lookup table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colorbar</span> <span class="o">=</span> <span class="n">LookupTable</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
    <span class="n">colorbar</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

    <span class="n">add</span><span class="p">(</span><span class="n">colorbar</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">colorbar</span></div>



<div class="viewcode-block" id="scatter">
<a class="viewcode-back" href="../../api/m3sh.vis.scatter.html#m3sh.vis.scatter">[docs]</a>
<span class="k">def</span> <span class="nf">scatter</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;spheres&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">dim_grey</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Scatter plot.</span>

<span class="sd">    Visual representation of `points`. Display spheres of given radius.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : array_like, shape (n, 3), n &gt; 1</span>
<span class="sd">        Point coordinates.</span>
<span class="sd">    style : str, optional</span>
<span class="sd">        Either &#39;spheres&#39; or &#39;cubes&#39;.</span>
<span class="sd">    size : float, optional</span>
<span class="sd">        Sphere radius.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Color intensity triplet.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Spheres</span>
<span class="sd">        Sphere congruence prop.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    If `points` is of type :class:`~numpy.ndarray` its data buffer is</span>
<span class="sd">    shared with VTK&#39;s data objects (use a copy of `points` to decouple</span>
<span class="sd">    storage).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pc</span> <span class="o">=</span> <span class="n">Spheres</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="n">pc</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">style</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">add</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pc</span></div>



<div class="viewcode-block" id="splat">
<a class="viewcode-back" href="../../api/m3sh.vis.splat.html#m3sh.vis.splat">[docs]</a>
<span class="k">def</span> <span class="nf">splat</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">snow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Point splatting.</span>

<span class="sd">    Display disk at locations orthogonal to given directions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : array_like</span>
<span class="sd">        Point locations.</span>
<span class="sd">    vectors : array_like</span>
<span class="sd">        Direction vectors.</span>
<span class="sd">    size : float, optional</span>
<span class="sd">        Disk radius.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Color specification.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">splats</span> <span class="o">=</span> <span class="n">Disks</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">)</span>

    <span class="n">splats</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
    <span class="n">splats</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">add</span><span class="p">(</span><span class="n">splats</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">splats</span></div>



<div class="viewcode-block" id="quiver">
<a class="viewcode-back" href="../../api/m3sh.vis.quiver.html#m3sh.vis.quiver">[docs]</a>
<span class="k">def</span> <span class="nf">quiver</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">green_pale</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Quiver plot.</span>

<span class="sd">    Display arrows at given locations pointing in given directions. For</span>
<span class="sd">    each point exactly one direction vector has to be given.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : array_like, shape (k, 3)</span>
<span class="sd">        Point coordinates.</span>
<span class="sd">    vectors : array_like, shape (k, 3)</span>
<span class="sd">        Vector coordinates.</span>
<span class="sd">    size : float, optional</span>
<span class="sd">        Global scale factor.</span>
<span class="sd">    radius : float, optional</span>
<span class="sd">        Unscaled radius of arrow shaft.</span>
<span class="sd">    resolution : int, optional</span>
<span class="sd">        Discretization detail level.</span>
<span class="sd">    color : array_like, optional</span>
<span class="sd">        Color specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Arrows</span>
<span class="sd">        Vector field prop.</span>


<span class="sd">    The glyph used to model arrows has unit length. The `radius` argument</span>
<span class="sd">    is an absolute value applied to this glyph. The `size` argument is a</span>
<span class="sd">    global scale factor applied to the glyph. It scales its length and</span>
<span class="sd">    radius. The detail level of the glyph (how many vertices are used to</span>
<span class="sd">    discretize a circle) can be set via the `resolution` argument.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    If `array_like` parameters are of type :class:`~numpy.ndarray` their</span>
<span class="sd">    data buffer is shared with VTK&#39;s data objects (use copies to decouple</span>
<span class="sd">    storage).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vf</span> <span class="o">=</span> <span class="n">Arrows</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">points</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">vectors</span><span class="p">),</span> <span class="n">radius</span><span class="p">,</span>
                <span class="mf">2.0</span> <span class="o">*</span> <span class="n">radius</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>

    <span class="n">vf</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
    <span class="n">vf</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">add</span><span class="p">(</span><span class="n">vf</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vf</span></div>



<span class="k">def</span> <span class="nf">_generic_lut</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">gradient</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">below</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">above</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nan</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Generate lookup table.</span>

<span class="sd">    Lookup table with `size` values in the given `range`. Gradient</span>
<span class="sd">    values drawn from</span>

<span class="sd">        {&#39;default&#39;, &#39;hot&#39;, &#39;jet&#39;, &#39;grey&#39;}</span>

<span class="sd">    generate a continuous color gradient whereas values from</span>

<span class="sd">        {&#39;spectral&#39;, &#39;diverging&#39;, &#39;blue&#39;, &#39;orange&#39;, &#39;purple&#39;}</span>

<span class="sd">    only define a fixed number of discrete colors. The `size` parameter</span>
<span class="sd">    has no effect in the latter case. Special colors can be assigned to</span>
<span class="sd">    values outside the specified range.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    range : (float, float), optional</span>
<span class="sd">        Range of table values.</span>
<span class="sd">    gradient : str, optional</span>
<span class="sd">        Name of color gradient.</span>
<span class="sd">    logscale : bool, optional</span>
<span class="sd">        Toggle logarithmic scaling.</span>
<span class="sd">    size : int, optional</span>
<span class="sd">        Number of table values.</span>
<span class="sd">    below : array_like, shape (4, )</span>
<span class="sd">        RGBA color for values below table range.</span>
<span class="sd">    above : array_like, shape (4, )</span>
<span class="sd">        RGBA color for values above table range.</span>
<span class="sd">    nan : array_like, shape (4, )</span>
<span class="sd">        RGBA color for NaN values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkLookupTable</span>
<span class="sd">        The generated lookup table.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Passing &#39;default&#39; as `gradient` will use VTK&#39;s default color gradient.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">gradient</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">}:</span>
        <span class="n">lut</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLookupTable</span><span class="p">()</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetNumberOfTableValues</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;hot&#39;</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetHueRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetSaturationRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetValueRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;jet&#39;</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetHueRange</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetSaturationRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetValueRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;grey&#39;</span> <span class="ow">or</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;gray&#39;</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetHueRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetSaturationRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetValueRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">lut</span><span class="o">.</span><span class="n">Build</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">gradient</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;spectral&#39;</span><span class="p">,</span> <span class="s1">&#39;diverging&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">}:</span>
        <span class="n">series</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkColorSeries</span><span class="p">()</span>

        <span class="nb">map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;spectral&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_DIVERGING_SPECTRAL_11</span><span class="p">,</span>
               <span class="s1">&#39;diverging&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_DIVERGING_BROWN_BLUE_GREEN_10</span><span class="p">,</span>
               <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_SEQUENTIAL_BLUE_GREEN_9</span><span class="p">,</span>
               <span class="s1">&#39;orange&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_SEQUENTIAL_YELLOW_ORANGE_BROWN_9</span><span class="p">,</span>
               <span class="s1">&#39;purple&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_SEQUENTIAL_BLUE_PURPLE_9</span><span class="p">}</span>

        <span class="n">series</span><span class="o">.</span><span class="n">SetColorScheme</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">gradient</span><span class="p">])</span>
        <span class="n">lut</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">CreateLookupTable</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">ORDINAL</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unknown color scheme &#39;</span><span class="si">{</span><span class="n">gradient</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="n">lut</span><span class="o">.</span><span class="n">SetTableRange</span><span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">logscale</span><span class="p">:</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetScaleToLog10</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">nan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetNanColor</span><span class="p">(</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">below</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetBelowRangeColor</span><span class="p">(</span><span class="n">below</span><span class="p">)</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetUseBelowRangeColor</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">above</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetAboveRangeColor</span><span class="p">(</span><span class="n">above</span><span class="p">)</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetUseAboveRangeColor</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lut</span>


<span class="k">def</span> <span class="nf">_tweak_lut</span><span class="p">(</span><span class="n">lut</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gradient</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Modify lookup table properties.</span>

<span class="sd">    An objects lookup tables determines how entries of the scalar array</span>
<span class="sd">    are translated to color values. Lookup tables have no effect when</span>
<span class="sd">    directly mapping RGB color values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    range : (float, float)</span>
<span class="sd">        Accpeted range of scalar values.</span>
<span class="sd">    gradient : str</span>
<span class="sd">        Color scheme identifier, see below.</span>
<span class="sd">    logscale : bool</span>
<span class="sd">        Switch between linear and logarithmic scale.</span>
<span class="sd">    size : int</span>
<span class="sd">        Size of lookup table.</span>

<span class="sd">    Keyword arguments</span>
<span class="sd">    -----------------</span>
<span class="sd">    below : array_like, shape (4, )</span>
<span class="sd">        Color for scalars below the specified range.</span>
<span class="sd">    above: array_like, shape (4, )</span>
<span class="sd">        Color for scalars above the specified range.</span>
<span class="sd">    nan : array_like, shape (4, )</span>
<span class="sd">        Special color for NaN scalar values.</span>


<span class="sd">    Smooth color gradients are defined by the color scheme identifiers</span>
<span class="sd">    &#39;hot&#39;, &#39;cool&#39;, &#39;jet&#39;, and &#39;grey&#39;. The color schemes &#39;spectral&#39;,</span>
<span class="sd">    &#39;diverging&#39;, &#39;blue&#39;, &#39;orange&#39;, and &#39;purple&#39; define a discrete color</span>
<span class="sd">    series.</span>

<span class="sd">    If provied, out of range values are marked with the `below`,</span>
<span class="sd">    `above`, and `nan` colors. Not that those colors also have an alpha</span>
<span class="sd">    intensity value to control opacity.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Arguments not provided have no affect on the corresponding lookup</span>
<span class="sd">    table property.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">gradient</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="s1">&#39;cool&#39;</span><span class="p">,</span> <span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">}:</span>
        <span class="k">if</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;hot&#39;</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetHueRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetSaturationRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetValueRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;cool&#39;</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetHueRange</span><span class="p">(</span><span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetSaturationRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetValueRange</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;jet&#39;</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetHueRange</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetSaturationRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetValueRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;grey&#39;</span> <span class="ow">or</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;gray&#39;</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetHueRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetSaturationRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetValueRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">lut</span><span class="o">.</span><span class="n">ForceBuild</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">gradient</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;spectral&#39;</span><span class="p">,</span> <span class="s1">&#39;diverging&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">}:</span>
        <span class="c1"># Color series define a fixed number of colors. A given size</span>
        <span class="c1"># parameter is ignored in this case.</span>
        <span class="n">series</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkColorSeries</span><span class="p">()</span>

        <span class="nb">map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;spectral&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_DIVERGING_SPECTRAL_11</span><span class="p">,</span>
               <span class="s1">&#39;diverging&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_DIVERGING_BROWN_BLUE_GREEN_10</span><span class="p">,</span>
               <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_SEQUENTIAL_BLUE_GREEN_9</span><span class="p">,</span>
               <span class="s1">&#39;orange&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_SEQUENTIAL_YELLOW_ORANGE_BROWN_9</span><span class="p">,</span>
               <span class="s1">&#39;purple&#39;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">BREWER_SEQUENTIAL_BLUE_PURPLE_9</span><span class="p">}</span>

        <span class="n">series</span><span class="o">.</span><span class="n">SetColorScheme</span><span class="p">(</span><span class="nb">map</span><span class="p">[</span><span class="n">gradient</span><span class="p">])</span>
        <span class="n">series</span><span class="o">.</span><span class="n">BuildLookupTable</span><span class="p">(</span><span class="n">lut</span><span class="p">,</span> <span class="n">series</span><span class="o">.</span><span class="n">ORDINAL</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">gradient</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
        <span class="c1"># This should reset the color gradient to some default value.</span>
        <span class="c1"># Currently does nothing.</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">gradient</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Nothing to do, no gradient argument defined.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unknown color scheme &#39;</span><span class="si">{</span><span class="n">gradient</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetTableRange</span><span class="p">(</span><span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">logscale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logscale</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetScaleToLog10</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetScaleToLinear</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Setting the size of a lookup table has no effect when using</span>
        <span class="c1"># a discrete color scheme.</span>
        <span class="n">lut</span><span class="o">.</span><span class="n">SetNumberOfTableValues</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

    <span class="c1"># Not passing a keyword argument will not alter the corresponding</span>
    <span class="c1"># setting. Passing a None value disables the corresponding feature.</span>
    <span class="k">if</span> <span class="s1">&#39;below&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">below</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;below&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>
            <span class="n">color</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">below</span><span class="p">)]</span> <span class="o">=</span> <span class="n">below</span>

            <span class="n">lut</span><span class="o">.</span><span class="n">SetBelowRangeColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetUseBelowRangeColor</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetUseBelowRangeColor</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;above&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">above</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;above&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>
            <span class="n">color</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">above</span><span class="p">)]</span> <span class="o">=</span> <span class="n">above</span>

            <span class="n">lut</span><span class="o">.</span><span class="n">SetBelowRangeColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetUseAboveRangeColor</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lut</span><span class="o">.</span><span class="n">SetUseAboveRangeColor</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">nan</span> <span class="o">:=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">.5</span><span class="p">]</span>
        <span class="n">color</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">nan</span><span class="p">)]</span> <span class="o">=</span> <span class="n">nan</span>

        <span class="n">lut</span><span class="o">.</span><span class="n">SetNanColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="c1"># else:</span>
    <span class="c1">#     lut.SetNanColor(None)</span>


<span class="k">def</span> <span class="nf">_app_icon</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s1">&#39;m3sh.png&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reader_factory</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageReader2Factory</span><span class="p">()</span>
    <span class="n">reader_factory</span><span class="o">.</span><span class="n">SetGlobalWarningDisplay</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">reader_factory</span><span class="o">.</span><span class="n">CreateImageReader2</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">SetFileName</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

        <span class="n">window</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>


<div class="viewcode-block" id="mesh">
<a class="viewcode-back" href="../../api/m3sh.vis.mesh.html#m3sh.vis.mesh">[docs]</a>
<span class="k">def</span> <span class="nf">mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">snow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Mesh visualization.</span>

<span class="sd">    Visualization of a polygonal mesh represented as a :class:`Mesh`</span>
<span class="sd">    instance or a 2-tuple holding an `array_like` vertex coordinate</span>
<span class="sd">    representation and a list of face definitions. The visual</span>
<span class="sd">    appearance of a mesh can be modified by using the methods and</span>
<span class="sd">    attributes of the returned object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mesh : Mesh or tuple</span>
<span class="sd">        Polygonal mesh representation.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        RGB color triple.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PolyMesh</span>
<span class="sd">        Polygonal mesh instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">renmesh</span> <span class="o">=</span> <span class="n">PolyMesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
    <span class="n">renmesh</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">add</span><span class="p">(</span><span class="n">renmesh</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">renmesh</span></div>



<div class="viewcode-block" id="graph">
<a class="viewcode-back" href="../../api/m3sh.vis.graph.html#m3sh.vis.graph">[docs]</a>
<span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">black</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Graph visualization.</span>

<span class="sd">    Experimental support for graph plotting. The `graph` parameter</span>
<span class="sd">    is described in more detail in SciPy&#39;s :mod:`~scipy.sparse.csgraph`</span>
<span class="sd">    module</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : array_like</span>
<span class="sd">        Node coordinate array.</span>
<span class="sd">    graph : csr_matrix</span>
<span class="sd">        Combinatorial graph definition.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Edge color.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PolyGraph</span>
<span class="sd">        Polygonal graph instance.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Conversion from a dense matrix repesentation can be achieved</span>
<span class="sd">    via the :func:`~scipy.sparse.csgraph.csgraph_from_dense` utility</span>
<span class="sd">    function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rengraph</span> <span class="o">=</span> <span class="n">PolyGraph</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">graph</span><span class="p">)</span>
    <span class="n">rengraph</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">add</span><span class="p">(</span><span class="n">rengraph</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rengraph</span></div>



<span class="k">def</span> <span class="nf">_tetmesh</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">tets</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">snow</span><span class="p">):</span>
    <span class="n">renmesh</span> <span class="o">=</span> <span class="n">_TetrahedralMesh</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">tets</span><span class="p">)</span>
    <span class="n">renmesh</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">add</span><span class="p">(</span><span class="n">renmesh</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">renmesh</span>


<span class="k">def</span> <span class="nf">_contour</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Contour plot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    M</span>
<span class="sd">        Either indexed or halfedge based mesh representation.</span>
<span class="sd">    S : array_like, shape (n, )</span>
<span class="sd">        A scalar value for each vertex of the mesh.</span>
<span class="sd">    levels : int, optional</span>
<span class="sd">        Number of level sets to generate.</span>
<span class="sd">    width : float, optional</span>
<span class="sd">        Line width in screen units.</span>
<span class="sd">    style : str, optional</span>
<span class="sd">        Line style used to display level sets.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Global RGB intensity triplet used as line color.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>
<span class="sd">        Corresponding actor object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Point and face array setup. Vertex coordinates and face definitions are</span>
    <span class="c1"># always given.</span>
    <span class="n">point_array</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">face_array</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>

    <span class="c1"># Detect the input type. A halfedge mesh M or and indexed mesh M = (V,F)</span>
    <span class="c1"># is expected as input.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">M</span><span class="o">.</span><span class="n">nverts</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">V</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mesh(): expecting indexed mesh (V, F) or halfedge &#39;</span> <span class="o">+</span>
                   <span class="s1">&#39;mesh M as input!&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The indexed mesh case. Fill vertex and face arrays. Texture</span>
            <span class="c1"># information on the face level is ignored.</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">point_array</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="n">point_array</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">F</span><span class="p">:</span>
                <span class="n">face</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">vdef</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">vdef</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                        <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">vdef</span><span class="p">)</span>
                <span class="n">face_array</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># The halfedge mesh case. The variables nverts and nfaces have</span>
        <span class="c1"># already been set.</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">M</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">point_array</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">point_array</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">M</span><span class="o">.</span><span class="n">faces</span><span class="p">():</span>
            <span class="n">face</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
                <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="n">face_array</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>

    <span class="n">polyData</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">polyData</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">point_array</span><span class="p">)</span>
    <span class="n">polyData</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">face_array</span><span class="p">)</span>

    <span class="n">float_array</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
    <span class="n">float_array</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span>
        <span class="n">float_array</span><span class="o">.</span><span class="n">InsertNextTuple1</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="n">polyData</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">float_array</span><span class="p">)</span>

    <span class="n">contour</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkContourFilter</span><span class="p">()</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">polyData</span><span class="p">)</span>
    <span class="n">contour</span><span class="o">.</span><span class="n">GenerateValues</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">contour</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">ScalarVisibilityOff</span><span class="p">()</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">actor</span>


<span class="k">def</span> <span class="nf">_silhouette</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Point and face array setup. Vertex coordinates and face definitions are</span>
    <span class="c1"># always given.</span>
    <span class="n">point_array</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">face_array</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>

    <span class="c1"># Detect the input type. A halfedge mesh M or and indexed mesh M = (V,F)</span>
    <span class="c1"># is expected as input.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">nverts</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">nvertices</span>
        <span class="n">nfaces</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">nfaces</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">V</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mesh(): expecting indexed mesh (V, F) or halfedge &#39;</span> <span class="o">+</span>
                   <span class="s1">&#39;mesh M as input!&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">point_array</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="n">point_array</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">F</span><span class="p">:</span>
                <span class="n">face</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">vdef</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">vdef</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                        <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">vdef</span><span class="p">)</span>
                <span class="n">face_array</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>

            <span class="n">nverts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
            <span class="n">nfaces</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">M</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">point</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">point_array</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">point_array</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">M</span><span class="o">.</span><span class="n">faces</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">isdeleted</span><span class="p">():</span>
                <span class="n">face</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
                    <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="n">face_array</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>

    <span class="n">polyData</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">polyData</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">point_array</span><span class="p">)</span>
    <span class="n">polyData</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">face_array</span><span class="p">)</span>

    <span class="n">silhouette</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataSilhouette</span><span class="p">()</span>
    <span class="n">silhouette</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">polyData</span><span class="p">)</span>
    <span class="n">silhouette</span><span class="o">.</span><span class="n">SetCamera</span><span class="p">(</span><span class="n">_renderer</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">())</span>
    <span class="c1"># silhouette-&gt;SetEnableFeatureAngle(0);</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">silhouette</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">actor</span>


<span class="k">def</span> <span class="nf">_cones</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">snow</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Cone rendering.</span>

<span class="sd">    Render cones with apices at the specified locations using the given</span>
<span class="sd">    vectors as cone axis. Cone shapes are defined by two sequences</span>
<span class="sd">    specifiying either cone angles, base radius, or cone height.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : array_like, shape (n, 3)</span>
<span class="sd">        Array of cone apices.</span>
<span class="sd">    vectors : array_like, shape (n, 3)</span>
<span class="sd">        Array of cone axes.</span>
<span class="sd">    angle : array_like of shape (n, ) or float</span>
<span class="sd">    radius : array_like of shape (n, ) or float</span>
<span class="sd">    height : array_like of shape (n, ) or float</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Object color.</span>
<span class="sd">    double : bool, optional</span>
<span class="sd">        :obj:`True` to generate double cones.</span>
<span class="sd">    cap : bool, optional</span>
<span class="sd">        :obj:`True` to close cones along their base.</span>
<span class="sd">    resolution : int, optional</span>
<span class="sd">        Number of vertices of base polygon.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ConeField</span>
<span class="sd">        The generated assembly of cones.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    In contrast to cone geometry, color cannot be specified on a per cone</span>
<span class="sd">    level, there is only one color for all cones in the assembly.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vectors</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array shapes don&#39;t match&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="n">angle</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array shapes don&#39;t match&quot;</span><span class="p">)</span>

        <span class="c1"># If there is an angle greater than 90 degrees the corresponding</span>
        <span class="c1"># axis should be inverted and the angle replaced by 180 - angle.</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;angle out of range, got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># This fix messes with the input data and produces side</span>
                <span class="c1"># effects. The data should be prepared properly before</span>
                <span class="c1"># visualization.</span>
                <span class="n">angle</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">alpha</span>
                <span class="n">vectors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="k">elif</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;angle has to be non-negative&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="n">radius</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array shapes don&#39;t match&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">height</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="n">height</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">height</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array shapes don&#39;t match&quot;</span><span class="p">)</span>

    <span class="n">conefield</span> <span class="o">=</span> <span class="n">_ConeField</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span>
                          <span class="n">double</span><span class="p">,</span> <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
    <span class="n">conefield</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">add</span><span class="p">(</span><span class="n">conefield</span><span class="o">.</span><span class="n">prop</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">conefield</span>


<div class="viewcode-block" id="cones">
<a class="viewcode-back" href="../../api/m3sh.vis.cones.html#m3sh.vis.cones">[docs]</a>
<span class="k">def</span> <span class="nf">cones</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">snow</span><span class="p">,</span> <span class="n">double</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Cone rendering.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vectors</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array shapes don&#39;t match&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="n">angle</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array shapes don&#39;t match&quot;</span><span class="p">)</span>

        <span class="c1"># If there is an angle greater than 90 degrees the corresponding</span>
        <span class="c1"># axis should be inverted and the angle replaced by 180 - angle.</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;angle out of range, got </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1"># This fix messes with the input data and produces side</span>
                <span class="c1"># effects. The data should be prepared properly before</span>
                <span class="c1"># visualization.</span>
                <span class="n">angle</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">alpha</span>
                <span class="n">vectors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="k">elif</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;angle has to be non-negative&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="n">radius</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array shapes don&#39;t match&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">height</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="n">height</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">height</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array shapes don&#39;t match&quot;</span><span class="p">)</span>

    <span class="n">cones</span> <span class="o">=</span> <span class="n">Cones</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span>
                  <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>

    <span class="n">cones</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="n">add</span><span class="p">(</span><span class="n">cones</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cones</span></div>



<span class="k">def</span> <span class="nf">_plot</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="plot">
<a class="viewcode-back" href="../../api/m3sh.vis.plot.html#m3sh.vis.plot">[docs]</a>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Polyline plotting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    P : array_like, shape (n, 3)</span>
<span class="sd">        Coordinate array of vertices.</span>
<span class="sd">    width : float</span>
<span class="sd">        Width of line segments in screen units.</span>
<span class="sd">    size: float</span>
<span class="sd">        Marker size in screen units.</span>
<span class="sd">    style : string</span>
<span class="sd">        A combination of &#39;.&#39;, &#39;o&#39;, &#39;-&#39;, and &#39;=&#39;.</span>
<span class="sd">    color : array_like, shape (3, )</span>
<span class="sd">        RGB color triplet for all line segments and markers.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vtkActor</span>
<span class="sd">        The corresponding actor object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">verts</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
            <span class="n">points</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>

            <span class="n">vert</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
            <span class="n">vert</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span>

            <span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
            <span class="n">line</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">line</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="n">polyData</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">polyData</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;o&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">):</span> <span class="n">polyData</span><span class="o">.</span><span class="n">SetVerts</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">):</span> <span class="n">polyData</span><span class="o">.</span><span class="n">SetLines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">polyData</span><span class="p">)</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetPointSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">if</span> <span class="s1">&#39;o&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span> <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderPointsAsSpheres</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">style</span><span class="p">:</span> <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">actor</span></div>



<div class="viewcode-block" id="box">
<a class="viewcode-back" href="../../api/m3sh.vis.box.html#m3sh.vis.box">[docs]</a>
<span class="k">def</span> <span class="nf">box</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">snow</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot; Box shape.</span>

<span class="sd">    Display the cuboid</span>
<span class="sd">    :math:`Q = [a_x, b_x] \times [a_y, b_y] \times [a_z, b_z]`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like, shape (3, )</span>
<span class="sd">        Min corner of the box.</span>
<span class="sd">    b : array_like, shape (3, )</span>
<span class="sd">        Max corner of the box.</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Opacity of box.</span>
<span class="sd">    edges : bool, optional</span>
<span class="sd">        Toggle edges of the box.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        RGB color triplet.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PolyMesh</span>
<span class="sd">        The corresponding polygonal shape representation.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Visual properties of the box edges can be further customized via</span>
<span class="sd">    the returned :class:`PolyMesh` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cube</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCubeSource</span><span class="p">()</span>
    <span class="n">cube</span><span class="o">.</span><span class="n">SetBounds</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                   <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">cube</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">box</span> <span class="o">=</span> <span class="n">PolyMesh</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
    <span class="n">box</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
    <span class="n">box</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="n">opacity</span>

    <span class="k">if</span> <span class="n">edges</span><span class="p">:</span>
        <span class="n">box</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">box</span></div>



<span class="k">def</span> <span class="nf">_circle</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">center</span><span class="p">))</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">data</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetNormals</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">normal</span><span class="p">))</span>
    <span class="n">data</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">radius</span><span class="p">))</span>

    <span class="n">circle</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkArcSource</span><span class="p">()</span>
    <span class="n">circle</span><span class="o">.</span><span class="n">SetCenter</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">circle</span><span class="o">.</span><span class="n">SetNormal</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">circle</span><span class="o">.</span><span class="n">SetPolarVector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">circle</span><span class="o">.</span><span class="n">SetAngle</span><span class="p">(</span><span class="mf">360.0</span><span class="p">)</span>
    <span class="n">circle</span><span class="o">.</span><span class="n">SetUseNormalAndAngle</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">circle</span><span class="o">.</span><span class="n">SetResolution</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
    <span class="c1"># circle.Update()</span>

    <span class="n">glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
    <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="n">circle</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

    <span class="n">glyph</span><span class="o">.</span><span class="n">OrientOn</span><span class="p">()</span>
    <span class="n">glyph</span><span class="o">.</span><span class="n">SetVectorModeToUseNormal</span><span class="p">()</span>

    <span class="n">glyph</span><span class="o">.</span><span class="n">ScalingOn</span><span class="p">()</span>
    <span class="n">glyph</span><span class="o">.</span><span class="n">SetScaleModeToScaleByScalar</span><span class="p">()</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarModeToUsePointData</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">ScalarVisibilityOff</span><span class="p">()</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">actor</span><span class="p">,</span> <span class="n">data</span>


<div class="viewcode-block" id="cylinder">
<a class="viewcode-back" href="../../api/m3sh.vis.cylinder.html#m3sh.vis.cylinder">[docs]</a>
<span class="k">def</span> <span class="nf">cylinder</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">cap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">grey</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Cylinder shape.</span>

<span class="sd">    Display cylinder with axis starting at point `a` and ending at</span>
<span class="sd">    point `b`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array_like, shape (3, )</span>
<span class="sd">        First point on cylinder axis.</span>
<span class="sd">    b : array_like, shape (3, )</span>
<span class="sd">        Last point on cylinder axis.</span>
<span class="sd">    radius : float</span>
<span class="sd">        Cylinder radius.</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Cylinder opacity.</span>
<span class="sd">    resolution : int, optional</span>
<span class="sd">        Number of sides.</span>
<span class="sd">    cap : bool, optional</span>
<span class="sd">        If :obj:`True` the cylinder is closed.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        RGB color triplet.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PolyData</span>
<span class="sd">        The corresponding polygonal shape representation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLineSource</span><span class="p">()</span>
    <span class="n">line</span><span class="o">.</span><span class="n">SetPoint1</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">line</span><span class="o">.</span><span class="n">SetPoint2</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="nb">filter</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTubeFilter</span><span class="p">()</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">SetNumberOfSides</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">SetCapping</span><span class="p">(</span><span class="n">cap</span><span class="p">)</span>
    <span class="c1"># filter.SetSidesShareVertices(False)</span>
    <span class="nb">filter</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">tube</span> <span class="o">=</span> <span class="n">PolyData</span><span class="p">(</span><span class="nb">filter</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
    <span class="n">tube</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
    <span class="n">tube</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="n">opacity</span>

    <span class="n">add</span><span class="p">(</span><span class="n">tube</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tube</span></div>



<div class="viewcode-block" id="sphere">
<a class="viewcode-back" href="../../api/m3sh.vis.sphere.html#m3sh.vis.sphere">[docs]</a>
<span class="k">def</span> <span class="nf">sphere</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">snow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Sphere shape.</span>

<span class="sd">    Covenience function that displays a sphere with given center and</span>
<span class="sd">    radius.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    center : array_like, shape (3, )</span>
<span class="sd">        Sphere center.</span>
<span class="sd">    radius : float</span>
<span class="sd">        Sphere radius.</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Opacity value.</span>
<span class="sd">    resolution : int, optional</span>
<span class="sd">        Angle discretization.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        RGB color triplet.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PolyData</span>
<span class="sd">        The corresponding polygonal shape representation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sphere</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkSphereSource</span><span class="p">()</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">SetCenter</span><span class="p">(</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">SetThetaResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">SetPhiResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">ball</span> <span class="o">=</span> <span class="n">PolyData</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
    <span class="n">ball</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
    <span class="n">ball</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="n">opacity</span>

    <span class="n">add</span><span class="p">(</span><span class="n">ball</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ball</span></div>



<span class="k">def</span> <span class="nf">_spheres</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize points at given (x,y,z) locations as spheres of a given radius</span>
<span class="sd">    and color. Unless you need differently sized point markers you should use</span>
<span class="sd">    scatter2() instead.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X, Y, Z : array_like</span>
<span class="sd">        Coordinate arrays need to be of the same shape.</span>
<span class="sd">    size : array_like</span>
<span class="sd">        A single scalar value used as radius for all spheres. To specify individual</span>
<span class="sd">        radii size needs to be of the same shape as the coordinate arrays.</span>
<span class="sd">    color : array_like</span>
<span class="sd">        Color intensity triplet(s). A single triplet specifies a global color</span>
<span class="sd">        for all points. To specify colors on a per point basis the last axis of</span>
<span class="sd">        col needs to hold color intensity triplets and each intensity channel</span>
<span class="sd">        col[..., i], i = 0,1,2, needs to be of the same shape as X, Y, and Z.</span>
<span class="sd">    scalar : array_like</span>
<span class="sd">        Scalar data associated with points, one scalar per point, i.e., the shape</span>
<span class="sd">        of the scalar data needs to match the match of X, Y, and Z. If specified</span>
<span class="sd">        color mapping based on scalar values takes precedence of direct coloring</span>
<span class="sd">        using the color array.</span>
<span class="sd">    cmap : string</span>
<span class="sd">        Color map identifier. Only used when scalar data is given. Invalid values</span>
<span class="sd">        prevents scalar based color mapping.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    actor :</span>
<span class="sd">        A vtk actor.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># In case the input is given as lists of lists etc. Won&#39;t change anything</span>
    <span class="c1"># if the input are already ndarrays (no copying or other overhead incurred).</span>
    <span class="c1"># C = np.asarray(C)</span>
    <span class="c1"># r = np.asarray(r)</span>

    <span class="c1"># assert len(C) == len(r)</span>

    <span class="c1"># Prepare the colors and the corresponding mapper</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarModeToUsePointFieldData</span><span class="p">()</span>

    <span class="c1"># Build the vtk representation of the point cloud</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">C</span><span class="p">:</span>
        <span class="n">points</span><span class="o">.</span><span class="n">InsertNextPoint</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="n">radius</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
    <span class="n">radius</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;glyph_size&#39;</span><span class="p">)</span>
    <span class="n">radius</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
        <span class="n">radius</span><span class="o">.</span><span class="n">InsertNextTuple1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Create a polydata to store everything in</span>
    <span class="n">polyData</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">polyData</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">polyData</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
    <span class="n">polyData</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetActiveScalars</span><span class="p">(</span><span class="s1">&#39;glyph_size&#39;</span><span class="p">)</span>

    <span class="c1"># The source shape used for glyphs. If rendering is too slow when there</span>
    <span class="c1"># is a large number of glyphs, the resolution of each sphere can be</span>
    <span class="c1"># reduced.</span>
    <span class="n">sphere</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkSphereSource</span><span class="p">()</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">SetThetaResolution</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">SetPhiResolution</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">sphere</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
    <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">polyData</span><span class="p">)</span>
    <span class="n">glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">glyph</span><span class="o">.</span><span class="n">ScalingOn</span><span class="p">()</span>
    <span class="n">glyph</span><span class="o">.</span><span class="n">SetScaleModeToScaleByScalar</span><span class="p">()</span>

    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">actor</span>


<span class="c1"># def tree(boxes):</span>
<span class="c1">#     tree = BoxArray(boxes)</span>
<span class="c1">#     tree.opacity = 0.5</span>

<span class="c1">#     for actor in tree.prop.GetParts():</span>
<span class="c1">#         actor.GetProperty().SetEdgeVisibility(True)</span>

<span class="c1">#     add(tree)</span>
<span class="c1">#     return tree</span>


<div class="viewcode-block" id="display">
<a class="viewcode-back" href="../../api/m3sh.vis.display.html#m3sh.vis.display">[docs]</a>
<span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">white</span><span class="p">,</span>
            <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Display static text in the render window.</span>

<span class="sd">    Location of the displayed text is given in normalized window</span>
<span class="sd">    coordinates, i.e., relative to the width and height of the render</span>
<span class="sd">    window.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    message : str</span>
<span class="sd">        The message to be displayed.</span>
<span class="sd">    x : float, optional</span>
<span class="sd">        Coordinate in the interval [0, 1].</span>
<span class="sd">    y : float, optional</span>
<span class="sd">        Coordinate in the interval [0, 1].</span>
<span class="sd">    size : int, optional</span>
<span class="sd">        Font size.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Prop</span>
<span class="sd">        The wrapped text actor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTextProperty</span><span class="p">()</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetFontSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetFontFamilyToCourier</span><span class="p">()</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetBold</span><span class="p">(</span><span class="n">bold</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetBackgroundColor</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">black</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetBackgroundOpacity</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetFrame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetItalic</span><span class="p">(</span><span class="n">italic</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetShadow</span><span class="p">(</span><span class="n">shadow</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">SetVerticalJustificationToTop</span><span class="p">()</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTextMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetTextProperty</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor2D</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetPositionCoordinate</span><span class="p">()</span><span class="o">.</span><span class="n">SetCoordinateSystemToNormalizedViewport</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetPositionCoordinate</span><span class="p">()</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Prop</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span></div>



<span class="k">def</span> <span class="nf">_put</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">follow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">black</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Text annotation.</span>

<span class="sd">    Puts the given text at a certain location. The text orientation</span>
<span class="sd">    remains static or it can follow the camera.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pos : array_like, shape (3, )</span>
<span class="sd">        Text location.</span>
<span class="sd">    dim : float</span>
<span class="sd">        Text dimension.</span>
<span class="sd">    text : str</span>
<span class="sd">        Text to be displayed.</span>
<span class="sd">    scale : float, optional</span>
<span class="sd">        Scale factor.</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Text opacity.</span>
<span class="sd">    axis : str, optional</span>
<span class="sd">        Text orientation, no effect when `follow` evaluates to :obj:`True`.</span>
<span class="sd">    follow : bool, optional</span>
<span class="sd">        :obj:`True` orients the text such that is always faces the camera.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        RGB triplet of color intensities.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Actor</span>
<span class="sd">        The created :class:`Actor` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vector_text</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkVectorText</span><span class="p">()</span>
    <span class="n">vector_text</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">vector_text</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">vector_text</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>

    <span class="c1"># An actor has its own GetBounds() method that takes the actor&#39;s</span>
    <span class="c1"># transformation into account.</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">GetBounds</span><span class="p">()</span>

    <span class="c1"># In its untransformed state the text is aligned along the positive</span>
    <span class="c1"># x-axis in the z=0 plane starting at the origin.</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">follow</span><span class="p">:</span>
        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFollower</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetCamera</span><span class="p">(</span><span class="n">_renderer</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;-x&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dim</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dim</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dim</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;-x&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetOrientation</span><span class="p">(</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">dim</span><span class="o">-</span><span class="n">dx</span><span class="p">),</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetOrientation</span><span class="p">(</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">dim</span><span class="o">-</span><span class="n">dx</span><span class="p">),</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetOrientation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">270.0</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">dim</span><span class="o">-</span><span class="n">dx</span><span class="p">))</span>

    <span class="n">actor</span><span class="o">.</span><span class="n">SetScale</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>

    <span class="c1"># The vtkFollower has to be modelled as Actor. Otherwise we could</span>
    <span class="c1"># also use PolyData as final render object.</span>
    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Prop</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_caption</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">textActor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCaptionActor2D</span><span class="p">()</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetAttachmentPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetCaption</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetBorder</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetThreeDimensionalLeader</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetLeader</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetWidth</span><span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetHeight</span><span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
    <span class="n">textActor</span><span class="o">.</span><span class="n">SetPadding</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># textActor.GetProperty().SetLineWidth(4)</span>

    <span class="n">textProp</span> <span class="o">=</span> <span class="n">textActor</span><span class="o">.</span><span class="n">GetCaptionTextProperty</span><span class="p">()</span>
    <span class="n">textProp</span><span class="o">.</span><span class="n">SetBackgroundColor</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">black</span><span class="p">)</span>
    <span class="n">textProp</span><span class="o">.</span><span class="n">SetBackgroundOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>
    <span class="n">textProp</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">textActor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">textActor</span>


<div class="viewcode-block" id="label">
<a class="viewcode-back" href="../../api/m3sh.vis.label.html#m3sh.vis.label">[docs]</a>
<span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">white</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Billboard text labels.</span>

<span class="sd">    Label that always faces the camera.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pos : array_like, shape (3, )</span>
<span class="sd">        Label position in space.</span>
<span class="sd">    text : str</span>
<span class="sd">        Text to be displayed.</span>
<span class="sd">    size : int, optional</span>
<span class="sd">        Font size.</span>
<span class="sd">    opacity : float, optional</span>
<span class="sd">        Label opacity.</span>
<span class="sd">    color : array_like, shape (3, ), optional</span>
<span class="sd">        Label color.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Prop</span>
<span class="sd">        The created :class:`Prop` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkBillboardTextActor3D</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetFontSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetJustificationToCentered</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetShadow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetBold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">opacity</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Prop</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span></div>



<span class="k">def</span> <span class="nf">_commands</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Toggle splash screen.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_renderer</span><span class="p">,</span> <span class="n">_splash</span>

    <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;----- Viewer commands -----</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                <span class="s1">&#39; q|e   close window</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                <span class="s1">&#39;   r   reset camera</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                <span class="s1">&#39;   h   toggle this message</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                <span class="s1">&#39; tab   toggle overlay&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_splash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="n">_renderer</span>
        <span class="n">_splash</span> <span class="o">=</span> <span class="n">canvas</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">display</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">_renderer</span> <span class="o">=</span> <span class="n">ren</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_renwin</span><span class="o">.</span><span class="n">RemoveRenderer</span><span class="p">(</span><span class="n">_splash</span><span class="p">)</span>
        <span class="n">_splash</span> <span class="o">=</span> <span class="kc">None</span>


<div class="viewcode-block" id="show">
<a class="viewcode-back" href="../../api/m3sh.vis.show.html#m3sh.vis.show">[docs]</a>
<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
         <span class="n">lmbdown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lmbup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rmbdown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rmbup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keydown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">keyup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mousemove</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Start the VTK event loop.</span>

<span class="sd">    Open window for rendering and start the VTK event loop.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    width : int, optional</span>
<span class="sd">        Window width in pixels.</span>
<span class="sd">    height : int, optional</span>
<span class="sd">        Window height in pixels.</span>
<span class="sd">    title : str, optional</span>
<span class="sd">        Window title.</span>
<span class="sd">    info : bool, optional</span>
<span class="sd">        Show rendering backend information.</span>
<span class="sd">    shadows : bool, optional</span>
<span class="sd">        Render shadows, experimental.</span>


<span class="sd">    This is a blocking function, a script will not advance beyond it until</span>
<span class="sd">    the event loop stops. Interaction with displayed objects has to be</span>
<span class="sd">    triggered by mouse and keyboard events and corresponding event handlers,</span>
<span class="sd">    see below.</span>

<span class="sd">    Keyword Arguments</span>
<span class="sd">    -----------------</span>
<span class="sd">    lmbdown : list[callable]</span>
<span class="sd">        Left button press callbacks.</span>
<span class="sd">    lmbup : list[callable]</span>
<span class="sd">        Left button release callbacks.</span>
<span class="sd">    rmbdown : list[callable]</span>
<span class="sd">        Right button press callbacks.</span>
<span class="sd">    rmbup : list[callable]</span>
<span class="sd">        Right button release callbacks.</span>
<span class="sd">    keydown : list[callable]</span>
<span class="sd">        Key press callbacks.</span>
<span class="sd">    keyup : list[callable]</span>
<span class="sd">        Key release callbacks.</span>
<span class="sd">    mousemove : list[callable]</span>
<span class="sd">        Mouse move callbacks.</span>


<span class="sd">    .. rubric:: Mouse and keyboard events</span>

<span class="sd">    Button and keyboard press and release events as well as mouse move</span>
<span class="sd">    events are recognized. Assign a list of callbacks to the corresponding</span>
<span class="sd">    keyword argument to register callback functions.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    If more than one callback is registered to an event, callbacks are</span>
<span class="sd">    executed in the given order.</span>


<span class="sd">    .. rubric:: Callback functions</span>

<span class="sd">    A callback function&#39;s signature has to be defined in the following way:</span>

<span class="sd">        .. py:function:: callback(iren, x, y, **kwargs)</span>

<span class="sd">           :param iren: Render window interactor.</span>
<span class="sd">           :type iren: vtkRenderWindowInteractor</span>
<span class="sd">           :param x: Display coordinates of the mouse cursor.</span>
<span class="sd">           :type x: int</span>
<span class="sd">           :param y: Display coordinates of the mouse cursor.</span>
<span class="sd">           :type y: int</span>


<span class="sd">    When activated the callback receives a handle to the affected render</span>
<span class="sd">    window via the corresponding render window interactor `iren` as well</span>
<span class="sd">    as the mouse cursor position inside this windows in pixels.</span>

<span class="sd">    The `iren` argument can also be used to query the status of modifier</span>
<span class="sd">    keys via its :meth:`GetShiftKey()`, :meth:`GetAltKey()`, and</span>
<span class="sd">    :meth:`GetControlKey()` methods.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    An object itself can be used as callback when it implements the</span>
<span class="sd">    :meth:`__call__` method.</span>


<span class="sd">    .. rubric:: Example</span>

<span class="sd">    Display a cube. Pressing the space bar will make a screenshot of the</span>
<span class="sd">    current window. Since we do not care about the cursor position when</span>
<span class="sd">    the space bar was pressed the positional arguments `x` and `y` are</span>
<span class="sd">    collected in the `*args` argument and ignored.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">       :linenos:</span>

<span class="sd">       import m3sh.vis as vis</span>

<span class="sd">       def key_press_callback(iren, *args, **kwargs):</span>
<span class="sd">           if iren.GetKeySym().lower() == &#39;space&#39;:</span>
<span class="sd">               vis.screenshot(&#39;box.png&#39;)</span>

<span class="sd">       vis.box([-1, -1, -1], [1, 1, 1], edges=True)</span>
<span class="sd">       vis.show(title=&#39;box&#39;, keydown=[key_press_callback])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Global state variables that are modified in this function. Should</span>
    <span class="c1"># be reset when show() terminates.</span>
    <span class="k">global</span> <span class="n">_renderer</span><span class="p">,</span> <span class="n">_renwin</span><span class="p">,</span> <span class="n">_splash</span>

    <span class="c1"># This method should only be called once. It can be called again in</span>
    <span class="c1"># a script if the active window has been closed.</span>
    <span class="k">if</span> <span class="n">_renwin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># Create a window, set its size and title. Multisampling is turned</span>
    <span class="c1"># off because of transparent objects.</span>
    <span class="n">_renwin</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindow</span><span class="p">()</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetWindowName</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetMultiSamples</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetAlphaBitPlanes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetNumberOfLayers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Create default viewport. The canvas() function adds the new</span>
        <span class="c1"># viewport to the renderers of the _renwin render window.</span>
        <span class="n">canvas</span><span class="p">()</span>

    <span class="c1"># This has been moved to canvas(). Each newly created renderer must</span>
    <span class="c1"># be treated this way. Leaving it here affects only the final one</span>
    <span class="c1"># created before calling show().</span>
    <span class="c1"># lightkit = vtk.vtkLightKit()</span>
    <span class="c1"># lightkit.AddLightsToRenderer(_renderer)</span>

    <span class="c1"># shadows = vtk.vtkShadowMapPass()</span>
    <span class="c1"># passes = vtk.vtkRenderPassCollection()</span>
    <span class="c1"># passes.AddItem(shadows.GetShadowMapBakerPass())</span>
    <span class="c1"># passes.AddItem(shadows)</span>

    <span class="c1"># seq = vtk.vtkSequencePass()</span>
    <span class="c1"># seq.SetPasses(passes)</span>

    <span class="c1"># camera_pass = vtk.vtkCameraPass()</span>
    <span class="c1"># camera_pass.SetDelegatePass(seq)</span>

    <span class="c1"># _renderer.SetPass(camera_pass)</span>

    <span class="c1"># Attach renderers to window. Each renderer is responsible for a</span>
    <span class="c1"># viewport inside the main render window.</span>
    <span class="k">while</span> <span class="n">_renderers</span><span class="p">:</span>
        <span class="n">renderer</span> <span class="o">=</span> <span class="n">_renderers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">_renwin</span><span class="o">.</span><span class="n">HasRenderer</span><span class="p">(</span><span class="n">renderer</span><span class="p">):</span>
            <span class="n">_renwin</span><span class="o">.</span><span class="n">AddRenderer</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="n">renderer</span><span class="o">.</span><span class="n">ResetCamera</span><span class="p">()</span>
        <span class="n">renderer</span><span class="o">.</span><span class="n">ResetCameraClippingRange</span><span class="p">()</span>

        <span class="c1"># Changing the render pipeline to include shadows (see above)</span>
        <span class="c1"># can also be obtained by this command. Note that shadows are</span>
        <span class="c1"># wrong when rendering to non-square windows (known bug). This</span>
        <span class="c1"># respects per viewport shadow settings when False.</span>
        <span class="k">if</span> <span class="n">shadows</span><span class="p">:</span>
            <span class="n">renderer</span><span class="o">.</span><span class="n">SetUseShadows</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Set fixed aspect ratio 1:1 to circumvent the shadow bug.</span>
            <span class="c1"># size = min(width, height)</span>
            <span class="c1"># _renwin.SetSize(size, size)</span>

    <span class="c1"># Set up the render window interactor with its customized trackball</span>
    <span class="c1"># interactor style.</span>
    <span class="n">iren</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindowInteractor</span><span class="p">()</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">SetRenderWindow</span><span class="p">(</span><span class="n">_renwin</span><span class="p">)</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">SetInteractorStyle</span><span class="p">(</span><span class="n">_MouseInteractorStyle</span><span class="p">(</span><span class="n">lmbdown</span><span class="p">,</span> <span class="n">lmbup</span><span class="p">,</span>
                                                  <span class="n">rmbdown</span><span class="p">,</span> <span class="n">rmbup</span><span class="p">,</span>
                                                  <span class="n">keydown</span><span class="p">,</span> <span class="n">keyup</span><span class="p">,</span> <span class="n">mousemove</span><span class="p">))</span>

    <span class="c1"># Add to the list of all render window interactors. If no windows</span>
    <span class="c1"># are created by window(), this will be a 1-element list.</span>
    <span class="n">_interactors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iren</span><span class="p">)</span>

    <span class="c1"># Calling this method later does not place the axes_widget at the</span>
    <span class="c1"># correct spot.</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>

    <span class="c1"># Set application window taskbar and dock icon.</span>
    <span class="n">_app_icon</span><span class="p">(</span><span class="n">_renwin</span><span class="p">)</span>

    <span class="c1"># Camera orientation widget was introduced in VTK 9.1, alterantively</span>
    <span class="c1"># we can show an axis widget.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkVersion</span><span class="o">.</span><span class="n">GetVTKMajorVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">8</span>
            <span class="ow">and</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkVersion</span><span class="o">.</span><span class="n">GetVTKMinorVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># A reference to the widget has to be maintained to prevent it</span>
        <span class="c1"># from being garbage collected immediately.</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCameraOrientationWidget</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetParentRenderer</span><span class="p">(</span><span class="n">_renderer</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">GetRepresentation</span><span class="p">()</span><span class="o">.</span><span class="n">SetPadding</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SquareResize</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Axes display in the lower left corner of each viewport. Only</span>
        <span class="c1"># shown in the active viewport, i.e., the one with mouse focus.</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOrientationMarkerWidget</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetOrientationMarker</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkAxesActor</span><span class="p">())</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetCurrentRenderer</span><span class="p">(</span><span class="n">_renderer</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetInteractor</span><span class="p">(</span><span class="n">iren</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetViewport</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="c1"># iren.axes_widget.SetSizeConstraintDimensionSizes(128, 256)</span>
        <span class="c1"># iren.axes_widget.SetShouldConstrainSize(True)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetInteractive</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Details about OpenGL support and hardware acceleration. Printed on</span>
    <span class="c1"># the overlay viewport.</span>
    <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="n">_renderer</span>

        <span class="k">if</span> <span class="n">_splash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_splash</span> <span class="o">=</span> <span class="n">canvas</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">canvas</span><span class="p">(</span><span class="n">_splash</span><span class="p">)</span>

        <span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VTK Version </span><span class="si">{</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkVersion</span><span class="o">.</span><span class="n">GetVTKVersion</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="sa">f</span><span class="s2">&quot;OpenGL support </span><span class="si">{</span><span class="n">_renwin</span><span class="o">.</span><span class="n">SupportsOpenGL</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="sa">f</span><span class="s2">&quot;Hardware acceleration </span><span class="si">{</span><span class="n">_renwin</span><span class="o">.</span><span class="n">IsDirect</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.15</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">_renderer</span> <span class="o">=</span> <span class="n">ren</span>

    <span class="c1"># Start the window interactor event loop. Closing the windows stops</span>
    <span class="c1"># the loop. Alternatively a more expensive polling loop can be used.</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>

    <span class="c1"># This is helpful in an interactive sessions in IPython. Also allows</span>
    <span class="c1"># us to call show() more than once in a script.</span>
    <span class="n">_interactors</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">_renderers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">_renwin</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_renderer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_splash</span> <span class="o">=</span> <span class="kc">None</span></div>



<span class="k">def</span> <span class="nf">_show</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">lmbdown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lmbup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rmbdown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rmbup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keydown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">keyup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mousemove</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Start the VTK event loop.</span>

<span class="sd">    Open window for rendering and start the VTK event loop.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    width : int, optional</span>
<span class="sd">        Window width in pixels.</span>
<span class="sd">    height : int, optional</span>
<span class="sd">        Window height in pixels.</span>
<span class="sd">    title : str, optional</span>
<span class="sd">        Window title.</span>
<span class="sd">    position : 2-tuple (int, int)</span>
<span class="sd">        Window position.</span>

<span class="sd">    Keyword Arguments</span>
<span class="sd">    -----------------</span>
<span class="sd">    lmbdown : list[callable]</span>
<span class="sd">        Left button press callbacks.</span>
<span class="sd">    lmbup : list[callable]</span>
<span class="sd">        Left button release callbacks.</span>
<span class="sd">    rmbdown : list[callable]</span>
<span class="sd">        Right button press callbacks.</span>
<span class="sd">    rmbup : list[callable]</span>
<span class="sd">        Right button release callbacks.</span>
<span class="sd">    keydown : list[callable]</span>
<span class="sd">        Key press callbacks.</span>
<span class="sd">    keyup : list[callable]</span>
<span class="sd">        Key release callbacks.</span>
<span class="sd">    mousemove : list[callable]</span>
<span class="sd">        Mouse move callbacks.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    This is a blocking function, a script will not advance beyond it until</span>
<span class="sd">    the event loop stops. Interaction with displayed objects has to be</span>
<span class="sd">    triggered by mouse and keyboard events and corresponding event handlers,</span>
<span class="sd">    see below.</span>


<span class="sd">    .. rubric:: Mouse and keyboard events</span>

<span class="sd">    Button press and release events as well as mouse move events are</span>
<span class="sd">    recognized. Key press and release events are recognized. Assign a list</span>
<span class="sd">    of callbacks to the corresponding keyword argument.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    If more than one callback is registered to an event, callbacks are</span>
<span class="sd">    executed in the given order.</span>


<span class="sd">    .. rubric:: Callback functions</span>

<span class="sd">    A callback function&#39;s signature has to be defined in the following way:</span>

<span class="sd">        .. py:function:: callback(iren, x, y, **kwargs)</span>

<span class="sd">           :param iren: Identifies the render window.</span>
<span class="sd">           :type iren: vtkRenderWindowInteractor</span>
<span class="sd">           :param x: Display coordinates of the mouse cursor.</span>
<span class="sd">           :type x: int</span>
<span class="sd">           :param y: Display coordinates of the mouse cursor.</span>
<span class="sd">           :type y: int</span>


<span class="sd">    When activated the callback receives a handle to the affected render</span>
<span class="sd">    window via the corresponding render window interactor `iren` as well</span>
<span class="sd">    as the mouse cursor position inside this windows in pixels.</span>

<span class="sd">    The `iren` argument can also be used to query the status of modifier</span>
<span class="sd">    keys via its :meth:`GetShiftKey()`, :meth:`GetAltKey()`, and</span>
<span class="sd">    :meth:`GetControlKey()` methods.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    An object itself can be used as callback when it implements the</span>
<span class="sd">    :meth:`__call__` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Global state variables that are modified in this function. Should</span>
    <span class="c1"># be reset when show() terminates.</span>
    <span class="k">global</span> <span class="n">_renderer</span><span class="p">,</span> <span class="n">_renwin</span><span class="p">,</span> <span class="n">_splash</span>

    <span class="c1"># This method should only be called once. It can be called again in</span>
    <span class="c1"># a script if the active window has been closed.</span>
    <span class="k">if</span> <span class="n">_interactors</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># Check if a previous window instance has been closed and should now</span>
    <span class="c1"># be displayed again.</span>
    <span class="k">if</span> <span class="n">_renwin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">_renwin</span><span class="o">.</span><span class="n">GetSize</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">_renwin</span><span class="o">.</span><span class="n">GetWindowName</span><span class="p">()</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">_renwin</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Only reset the camera if this is the first time the render</span>
        <span class="c1"># window is displayed.</span>
        <span class="k">for</span> <span class="n">renderer</span> <span class="ow">in</span> <span class="n">_renderers</span><span class="p">:</span>
            <span class="n">renderer</span><span class="o">.</span><span class="n">ResetCamera</span><span class="p">()</span>

    <span class="c1"># Create a window, set its size and title. Multisampling is turned</span>
    <span class="c1"># off because of transparent objects.</span>
    <span class="n">_renwin</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindow</span><span class="p">()</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetWindowName</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetMultiSamples</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetAlphaBitPlanes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">SetNumberOfLayers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Create default viewport. The canvas() function adds the new</span>
        <span class="c1"># viewport to the renderers of the _renwin render window.</span>
        <span class="n">canvas</span><span class="p">()</span>

    <span class="c1"># Attach renderers to window. Each renderer is responsible for a</span>
    <span class="c1"># viewport inside the main render window.</span>
    <span class="k">for</span> <span class="n">renderer</span> <span class="ow">in</span> <span class="n">_renderers</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_renwin</span><span class="o">.</span><span class="n">HasRenderer</span><span class="p">(</span><span class="n">renderer</span><span class="p">):</span>
            <span class="n">_renwin</span><span class="o">.</span><span class="n">AddRenderer</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

    <span class="c1"># Set up the render window interactor with its customized trackball</span>
    <span class="c1"># interactor style.</span>
    <span class="n">iren</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindowInteractor</span><span class="p">()</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">SetRenderWindow</span><span class="p">(</span><span class="n">_renwin</span><span class="p">)</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">SetInteractorStyle</span><span class="p">(</span><span class="n">_MouseInteractorStyle</span><span class="p">(</span><span class="n">lmbdown</span><span class="p">,</span> <span class="n">lmbup</span><span class="p">,</span>
                                                  <span class="n">rmbdown</span><span class="p">,</span> <span class="n">rmbup</span><span class="p">,</span>
                                                  <span class="n">keydown</span><span class="p">,</span> <span class="n">keyup</span><span class="p">,</span> <span class="n">mousemove</span><span class="p">))</span>

    <span class="c1"># Add to the list of all render window interactors. If no windows</span>
    <span class="c1"># are created by window(), this will be a 1-element list.</span>
    <span class="n">_interactors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iren</span><span class="p">)</span>

    <span class="c1"># Calling this method later does not place the axes_widget at the</span>
    <span class="c1"># correct spot.</span>
    <span class="n">_renwin</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>

    <span class="c1"># Set application window taskbar and dock icon.</span>
    <span class="n">_app_icon</span><span class="p">(</span><span class="n">_renwin</span><span class="p">)</span>

    <span class="c1"># Camera orientation widget was introduced in VTK 9.1, alterantively</span>
    <span class="c1"># we can show an axis widget.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkVersion</span><span class="o">.</span><span class="n">GetVTKMajorVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">8</span>
            <span class="ow">and</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkVersion</span><span class="o">.</span><span class="n">GetVTKMinorVersion</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># A reference to the widget has to be maintained to prevent it</span>
        <span class="c1"># from being garbage collected immediately.</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCameraOrientationWidget</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetParentRenderer</span><span class="p">(</span><span class="n">_renderer</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">GetRepresentation</span><span class="p">()</span><span class="o">.</span><span class="n">SetPadding</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SquareResize</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Axes display in the lower left corner of each viewport. Only</span>
        <span class="c1"># shown in the active viewport, i.e., the one with mouse focus.</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOrientationMarkerWidget</span><span class="p">()</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetOrientationMarker</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkAxesActor</span><span class="p">())</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetCurrentRenderer</span><span class="p">(</span><span class="n">_renderer</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetInteractor</span><span class="p">(</span><span class="n">iren</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetViewport</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="c1"># iren.axes_widget.SetSizeConstraintDimensionSizes(128, 256)</span>
        <span class="c1"># iren.axes_widget.SetShouldConstrainSize(True)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetInteractive</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Details about OpenGL support and hardware acceleration. Printed on</span>
    <span class="c1"># the overlay viewport.</span>
    <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="n">_renderer</span>

        <span class="k">if</span> <span class="n">_splash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_splash</span> <span class="o">=</span> <span class="n">canvas</span><span class="p">(</span><span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">canvas</span><span class="p">(</span><span class="n">_splash</span><span class="p">)</span>

        <span class="n">display</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VTK Version </span><span class="si">{</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkVersion</span><span class="o">.</span><span class="n">GetVTKVersion</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="sa">f</span><span class="s2">&quot;OpenGL support </span><span class="si">{</span><span class="n">_renwin</span><span class="o">.</span><span class="n">SupportsOpenGL</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="sa">f</span><span class="s2">&quot;Hardware acceleration </span><span class="si">{</span><span class="n">_renwin</span><span class="o">.</span><span class="n">IsDirect</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.15</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">_renderer</span> <span class="o">=</span> <span class="n">ren</span>

    <span class="c1"># Start the window interactor event loop. Closing the windows stops</span>
    <span class="c1"># the loop. Alternatively a more expensive polling loop can be used.</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>

    <span class="c1"># This is helpful in an interactive sessions in IPython. Also allows</span>
    <span class="c1"># us to call show() more than once in a script.</span>
    <span class="n">_interactors</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="c1"># _renderers.clear()</span>

    <span class="c1"># _renwin = None</span>
    <span class="c1"># _renderer = None</span>
    <span class="c1"># _splash = None</span>


<div class="viewcode-block" id="pick">
<a class="viewcode-back" href="../../api/m3sh.vis.pick.html#m3sh.vis.pick">[docs]</a>
<span class="k">def</span> <span class="nf">pick</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="n">iren</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Perform pick action.</span>

<span class="sd">    Performs a pick operation at certain display coordinates. Cell and point</span>
<span class="sd">    picking is supported.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : int</span>
<span class="sd">        Pick position in display coordinates.</span>
<span class="sd">    y : int</span>
<span class="sd">        Pick position in display coordinates.</span>
<span class="sd">    type : str, optional</span>
<span class="sd">        Either &#39;cell&#39; or &#39;point&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    actor : vtkActor</span>
<span class="sd">        Results in :obj:`None` if nothing was picked.</span>
<span class="sd">    cell_id : int</span>
<span class="sd">        Cell identifier, -1 if no cell was picked.</span>
<span class="sd">    point_id : int</span>
<span class="sd">        Point identifier, -1 if no point was picked.</span>
<span class="sd">    point : ndarray</span>
<span class="sd">        World coordinates of the picked point.</span>


<span class="sd">    By default all render objects created by functions in this module are</span>
<span class="sd">    not pickable. To make an actor available for picking, modify its</span>
<span class="sd">    :attr:`~Actor.pickable` attribute.</span>

<span class="sd">    A successful pick operation returns the picked actor and information about</span>
<span class="sd">    the picked cell or point, respectively.</span>

<span class="sd">    When picking cells the coordinates of the intersection of the pick ray</span>
<span class="sd">    and the picked cell is returned in `point`. In addition to the index</span>
<span class="sd">    `cell_id` of the picked cell, the index of the closest vertex of the</span>
<span class="sd">    picked cells to this location is returned as `point_id`.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    This function returns three values when picking points and four values</span>
<span class="sd">    when picking cells.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the viewport that corresponds to the given location. What happens</span>
    <span class="c1"># if window coordinates are out of bounds?</span>
    <span class="k">if</span> <span class="n">iren</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">iren</span> <span class="o">=</span> <span class="n">_renwin</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>

    <span class="n">ren</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">FindPokedRenderer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># The pick was successful, i.e., an actor was intersected with the pick</span>
    <span class="c1"># ray if the actor returend by the picker is not None.</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;point&#39;</span><span class="p">:</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPointPicker</span><span class="p">()</span>
        <span class="n">picker</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ren</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">picker</span><span class="o">.</span><span class="n">GetActor</span><span class="p">(),</span>
                <span class="n">picker</span><span class="o">.</span><span class="n">GetPointId</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">picker</span><span class="o">.</span><span class="n">GetPickPosition</span><span class="p">()))</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;cell&#39;</span><span class="p">:</span>
        <span class="n">picker</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellPicker</span><span class="p">()</span>
        <span class="n">picker</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ren</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">picker</span><span class="o">.</span><span class="n">GetActor</span><span class="p">(),</span> <span class="n">picker</span><span class="o">.</span><span class="n">GetCellId</span><span class="p">(),</span>
                <span class="n">picker</span><span class="o">.</span><span class="n">GetPointId</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">picker</span><span class="o">.</span><span class="n">GetPickPosition</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid pick style &#39;</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>



<span class="k">def</span> <span class="nf">_main</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">argparse</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;OBJ input file&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--bounds&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;show AABB&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--edges&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;show edges&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--flat&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;flat shading&#39;</span><span class="p">)</span>
    <span class="c1"># parser.add_argument(&#39;--silhouette&#39;, action=&#39;store_true&#39;)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">canvas</span><span class="p">(</span><span class="n">color2</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">black</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">file</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOBJReader</span><span class="p">()</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">SetFileName</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

        <span class="n">add</span><span class="p">(</span><span class="n">mesh</span> <span class="o">:=</span> <span class="n">PolyMesh</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">()))</span>

        <span class="c1"># Only for testing, remove later...</span>
        <span class="c1"># scalars = mesh.points[:, 2]</span>
        <span class="c1"># mesh.colorize(scalars, items=&#39;verts&#39;, interpolate_scalars=True)</span>
        <span class="c1"># mesh.lookuptable((min(scalars), max(scalars)), gradient=&#39;spectral&#39;)</span>

        <span class="k">if</span> <span class="n">mesh</span><span class="o">.</span><span class="n">normals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">quiver</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">_avg_edge_length</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">bounds</span><span class="p">:</span>
            <span class="n">aabb</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
            <span class="n">mesh</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetInterpolationToFlat</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="n">mesh</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">ivory_black</span><span class="p">)</span>

        <span class="c1"># if args.silhouette:</span>
        <span class="c1">#     mesh.silhouette(width=4, color=colors.black)</span>

    <span class="c1"># Window title holds the list of all given filenames even if only</span>
    <span class="c1"># one file was given.</span>
    <span class="n">show</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_show_vertex_index_cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pick</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;cell&#39;</span><span class="p">,</span> <span class="n">iren</span><span class="o">=</span><span class="n">iren</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>


<span class="k">def</span> <span class="nf">_show_cell_labels</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdFilter</span><span class="p">()</span>
    <span class="n">ids</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>
    <span class="n">ids</span><span class="o">.</span><span class="n">SetPointIds</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ids</span><span class="o">.</span><span class="n">SetCellIds</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">cc</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellCenters</span><span class="p">()</span>
    <span class="n">cc</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">ids</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

    <span class="c1"># Labels are drawn on top of all other objects. It should be possible</span>
    <span class="c1"># to take visibility into account.</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLabeledDataMapper</span><span class="p">()</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">mapper</span><span class="o">.</span><span class="n">SetLabelModeToLabelScalars</span><span class="p">()</span>

    <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor2D</span><span class="p">()</span>
    <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

    <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Prop</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>


<div class="viewcode-block" id="Prop">
<a class="viewcode-back" href="../../api/m3sh.vis.Prop.html#m3sh.vis.Prop">[docs]</a>
<span class="k">class</span> <span class="nc">Prop</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Render object.</span>

<span class="sd">    Base class for all VTK wrappers.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    prop : vtkProp</span>
<span class="sd">        Instance of a render object.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Wrapped objects are not pickable by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span> <span class="o">=</span> <span class="n">prop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Wrapped VTK instance.</span>

<span class="sd">        Access the wrapped render object. Exposes all low-level</span>
<span class="sd">        interaction with this object.</span>

<span class="sd">        :type: vtkProp</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">actor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Actor instance.</span>

<span class="sd">        Access the associated actor. Generically this is equal to</span>
<span class="sd">        the :attr:`prop` attribute.</span>

<span class="sd">        :type: vtkActor</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Derived classes should provide their own implementation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Prop name.</span>

<span class="sd">        Set and get name of the prop (empty by default).</span>

<span class="sd">        :type: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetObjectName</span><span class="p">()</span>

    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">SetObjectName</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Axis aligned bounding box.</span>

<span class="sd">        Pair holding the min and max values along each of the three</span>
<span class="sd">        coordinate dimensions.</span>

<span class="sd">        :type: tuple[ndarray, ndarray]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetBounds</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">visible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Visibility property.</span>

<span class="sd">        Query and toggle object visibility.</span>

<span class="sd">        :type: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetVisibility</span><span class="p">()</span>

    <span class="nd">@visible</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">SetVisibility</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pickable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Pickable property.</span>

<span class="sd">        Query and toggle whether object geometry can be picked. Objects</span>
<span class="sd">        are not pickable by default.</span>

<span class="sd">        :type: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetPickable</span><span class="p">()</span>

    <span class="nd">@pickable</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">pickable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>



<div class="viewcode-block" id="PropertyMixin">
<a class="viewcode-back" href="../../api/m3sh.vis.PropertyMixin.html#m3sh.vis.PropertyMixin">[docs]</a>
<span class="k">class</span> <span class="nc">PropertyMixin</span><span class="p">:</span>
    <span class="c1"># Assumes that self._vtk_prop is derived from a class that provides</span>
    <span class="c1"># the GetProperty() method.</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Opacity property.</span>

<span class="sd">        Set and get opacity value.</span>

<span class="sd">        :type: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">GetOpacity</span><span class="p">()</span>

    <span class="nd">@opacity</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetOpacity</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


    <span class="c1"># Render and interpolation styles... needs more work!</span>
    <span class="c1"># @property</span>
    <span class="c1"># def flat(self):</span>
    <span class="c1">#     return self._vtk_prop.GetProperty().GetOpacity()</span>

    <span class="c1"># @opacity.setter</span>
    <span class="c1"># def flat(self, value):</span>
    <span class="c1">#     self._vtk_prop.GetProperty().SetOpacity(value)</span>


<div class="viewcode-block" id="MapperMixin">
<a class="viewcode-back" href="../../api/m3sh.vis.MapperMixin.html#m3sh.vis.MapperMixin">[docs]</a>
<span class="k">class</span> <span class="nc">MapperMixin</span><span class="p">:</span>
    <span class="c1"># Assumes that self._vtk_prop is derived from a class that provides</span>
    <span class="c1"># the GetMapper() method.</span>

<div class="viewcode-block" id="MapperMixin.lookuptable">
<a class="viewcode-back" href="../../api/m3sh.vis.MapperMixin.lookuptable.html#m3sh.vis.MapperMixin.lookuptable">[docs]</a>
    <span class="k">def</span> <span class="nf">lookuptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gradient</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Modify lookup table properties.</span>

<span class="sd">        An objects&#39; lookup tables determines how entries of the scalar array</span>
<span class="sd">        are translated to color values. Smooth color gradients are defined</span>
<span class="sd">        by the color schemes &#39;hot&#39;, &#39;cool&#39;, &#39;jet&#39;, and &#39;grey&#39;. The color</span>
<span class="sd">        schemes &#39;spectral&#39;, &#39;diverging&#39;, &#39;blue&#39;, &#39;orange&#39;, and &#39;purple&#39;</span>
<span class="sd">        define a discrete color series.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        range : (float, float)</span>
<span class="sd">            Accpeted range of scalar values, default [0, 1].</span>
<span class="sd">        gradient : str</span>
<span class="sd">            Color scheme identifier.</span>
<span class="sd">        logscale : bool</span>
<span class="sd">            Switch between linear and logarithmic scale.</span>
<span class="sd">        size : int</span>
<span class="sd">            Size of lookup table.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Lookup tables have no effect when directly mapping RGB color values.</span>


<span class="sd">        If the corresponding keyword arguments are provied, out of range</span>
<span class="sd">        values are marked with the `below`, `above`, and `nan` colors. Note</span>
<span class="sd">        that those colors also have an alpha value to control opacity.</span>

<span class="sd">        Keyword arguments</span>
<span class="sd">        -----------------</span>
<span class="sd">        below : array_like, shape (4, )</span>
<span class="sd">            Color for scalars below range.</span>
<span class="sd">        above: array_like, shape (4, )</span>
<span class="sd">            Color for scalars above range.</span>
<span class="sd">        nan : array_like, shape (4, )</span>
<span class="sd">            Special color for NaN scalar values.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Any arguments not provided have no affect on the corresponding lookup</span>
<span class="sd">        table property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The current lookup table. Properties are modified according to the</span>
        <span class="c1"># given parameters. None values preserve the corresponding property.</span>
        <span class="n">lut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetLookupTable</span><span class="p">()</span>
        <span class="n">_tweak_lut</span><span class="p">(</span><span class="n">lut</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="GlyphMixin">
<a class="viewcode-back" href="../../api/m3sh.vis.GlyphMixin.html#m3sh.vis.GlyphMixin">[docs]</a>
<span class="k">class</span> <span class="nc">GlyphMixin</span><span class="p">:</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Size property.</span>

<span class="sd">        Set and get global size for all glyphs.</span>

<span class="sd">        :type: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Global scale factor that is multiplied by scalars values if</span>
        <span class="c1"># used to set per point scale factors.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">GetScaleFactor</span><span class="p">()</span>

    <span class="nd">@size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetScaleFactor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="GlyphMixin.scale">
<a class="viewcode-back" href="../../api/m3sh.vis.GlyphMixin.scale.html#m3sh.vis.GlyphMixin.scale">[docs]</a>
    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Scale glyph geometry.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values : array_like</span>
<span class="sd">            Per point scale factors.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Scale factors and :attr:`size` are multiplied to obtain the final</span>
<span class="sd">        size of a glyph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetScaling</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetScaleModeToScaleByScalar</span><span class="p">()</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Color property.</span>

<span class="sd">        Setting the color attribute disables coloring using previously</span>
<span class="sd">        set scalars with :meth:`colorize`.</span>

<span class="sd">        :type: array_like, shape (3, )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">GetColor</span><span class="p">()</span>

    <span class="nd">@color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="GlyphMixin.colorize">
<a class="viewcode-back" href="../../api/m3sh.vis.GlyphMixin.colorize.html#m3sh.vis.GlyphMixin.colorize">[docs]</a>
    <span class="k">def</span> <span class="nf">colorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalars</span><span class="p">):</span>
        <span class="n">numpts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetNumberOfPoints</span><span class="p">()</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">numpts</span><span class="p">,</span> <span class="p">)</span> <span class="ow">or</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">numpts</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

            <span class="n">colors</span> <span class="o">=</span> <span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_colors</span><span class="p">)</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>

            <span class="c1"># This will replaces an array of the same name if present.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

            <span class="n">mapper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarModeToUsePointFieldData</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SelectColorArray</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Direct colors is the array has 3 components, otherwise</span>
            <span class="c1"># map the scalars through the lookup table.</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">numpts</span><span class="p">,</span> <span class="p">):</span>
                <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToMapScalars</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToDirectScalars</span><span class="p">()</span></div>


<div class="viewcode-block" id="GlyphMixin.modified">
<a class="viewcode-back" href="../../api/m3sh.vis.GlyphMixin.modified.html#m3sh.vis.GlyphMixin.modified">[docs]</a>
    <span class="k">def</span> <span class="nf">modified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Update notification.</span>

<span class="sd">        Should be called when the contents of a shared data buffer are</span>
<span class="sd">        modified.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Changing the **shape** of a shared data buffer is likely to</span>
<span class="sd">        result in a segmentation fault or other undefined behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span></div>
</div>



<span class="c1"># class BoxArray(Actor):</span>

<span class="c1">#     def __init__(self, boxes):</span>
<span class="c1">#         prop = vtk.vtkPropAssembly()</span>

<span class="c1">#         for box in boxes:</span>
<span class="c1">#             prop.AddPart(self._build(box[0, :], box[1, :]))</span>

<span class="c1">#         super().__init__(prop)</span>

<span class="c1">#     def _build(self, a, b):</span>
<span class="c1">#         cube = vtk.vtkCubeSource()</span>
<span class="c1">#         cube.SetBounds(a[0], b[0],</span>
<span class="c1">#                        a[1], b[1],</span>
<span class="c1">#                        a[2], b[2])</span>
<span class="c1">#         cube.Update()</span>

<span class="c1">#         mapper = vtk.vtkPolyDataMapper()</span>
<span class="c1">#         mapper.SetInputData(cube.GetOutput())</span>

<span class="c1">#         actor = vtk.vtkActor()</span>
<span class="c1">#         actor.SetMapper(mapper)</span>

<span class="c1">#         return actor</span>


<span class="k">class</span> <span class="nc">_ConeField</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Family of cones.</span>

<span class="sd">    Visual representation of a family of (double) cones. Individual cones</span>
<span class="sd">    are defined by their apex, height, and base radius. Either the height</span>
<span class="sd">    or radius may be replaced by an angle. Specifiying all three values is</span>
<span class="sd">    considered as invalid input.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : array_like</span>
<span class="sd">        Point cloud in 3-space, one point per row. Each point defines</span>
<span class="sd">        the apex of a cone.</span>
<span class="sd">    vectors : array_like</span>
<span class="sd">        Vector field in 3-space, one vector per row. Vectors define</span>
<span class="sd">        cone axis directions and don&#39;t have to be normalized.</span>
<span class="sd">    angle : array_like</span>
<span class="sd">        One angle per cone. Angles are measured in radians.</span>
<span class="sd">    radius : array_like</span>
<span class="sd">        One positive radius per cone.</span>
<span class="sd">    height : array_like</span>
<span class="sd">        One non-negative height per cone.</span>
<span class="sd">    double : bool</span>
<span class="sd">        :obj:`True` will generate double cones.</span>
<span class="sd">    cap : bool</span>
<span class="sd">        :obj:`True` to close the cone along its base.</span>
<span class="sd">    resolution : int</span>
<span class="sd">        The number of vertices along the base circle.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    One of `angle`, `height`, `radius` has to be explicitly set the</span>
<span class="sd">    :obj:`None` during initialization. Note that `angle` refers to half the</span>
<span class="sd">    opening angle of a cone.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span>
                 <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">):</span>
        <span class="c1"># Convert to ndarray. The data buffers of the resulting arrays</span>
        <span class="c1"># are then shared with VTK. If the arguments are already of type</span>
        <span class="c1"># ndarray no data duplication happens.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vecpos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>

        <span class="c1"># This will be shared by both polydata objects when displaying</span>
        <span class="c1"># double cones.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">))</span>

        <span class="c1"># The index array is also only needed once and shared in case of</span>
        <span class="c1"># double cones.</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIntArray</span><span class="p">()</span>
        <span class="n">indices</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">indices</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)):</span>
            <span class="n">indices</span><span class="o">.</span><span class="n">InsertNextTuple1</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span> <span class="o">=</span> <span class="n">indices</span>

        <span class="c1"># We define cones from radius and height. If one of those is missing</span>
        <span class="c1"># it is computed using the angle value (required in this case).</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">height</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;wrong number of arguments&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">double</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vecneg</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">vecpos</span>

            <span class="n">prop</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPropAssembly</span><span class="p">()</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">AddPart</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_build</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vecpos</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span>
                                     <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">))</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">AddPart</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_build</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vecneg</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span>
                                     <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vecpos</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">capping</span><span class="p">,</span> <span class="n">resolution</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Build glyph representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetVectors</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">axis</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">)</span>

        <span class="n">glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="p">)</span>

        <span class="c1"># The source shape used for glyphs. If rendering is too slow when</span>
        <span class="c1"># there is a large number of glyphs, the resolution can be reduced.</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
            <span class="n">cone</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkConeSource</span><span class="p">()</span>
            <span class="n">cone</span><span class="o">.</span><span class="n">SetResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
            <span class="n">cone</span><span class="o">.</span><span class="n">SetCapping</span><span class="p">(</span><span class="n">capping</span><span class="p">)</span>

            <span class="c1"># Cone source objects only accepts non-negative values for height</span>
            <span class="c1"># and radius, angles have to be in the range [0.0, 90.0]. In all</span>
            <span class="c1"># other cases no shape is displayed without any error message.</span>
            <span class="n">cone</span><span class="o">.</span><span class="n">SetHeight</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
            <span class="n">cone</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="n">cone</span><span class="o">.</span><span class="n">SetCenter</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

            <span class="n">glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

        <span class="n">glyph</span><span class="o">.</span><span class="n">SetRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetIndexModeToScalar</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputArrayToProcess</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">OrientOn</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetVectorModeToUseVector</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">ScalingOff</span><span class="p">()</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarModeToUsePointFieldData</span><span class="p">()</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">actor</span>


<span class="k">class</span> <span class="nc">_VectorField</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">green_pale</span><span class="p">,</span>
                 <span class="n">shaft_radius</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tip_length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">resolution</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
        <span class="c1"># The source shape used for glyphs. Reduce resolution if rendering</span>
        <span class="c1"># is too slow when a large number of glyphs is displayed.</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_source</span><span class="p">(</span><span class="n">shaft_radius</span><span class="p">,</span> <span class="n">tip_radius</span><span class="p">,</span> <span class="n">tip_length</span><span class="p">,</span>
                                  <span class="n">resolution</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">GetData</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">GetNormals</span><span class="p">())</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">data</span>

            <span class="n">glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="n">arrow</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">OrientOn</span><span class="p">()</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetVectorModeToUseNormal</span><span class="p">()</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetScaleModeToDataScalingOff</span><span class="p">()</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetScaleFactor</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>

            <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">ScalarVisibilityOff</span><span class="p">()</span>

            <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;infinite vector coordinate(s)&#39;</span><span class="p">)</span>

            <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
            <span class="n">points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">))</span>

            <span class="n">scalars</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
            <span class="n">scalars</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">scalars</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;glyph_scale&#39;</span><span class="p">)</span>

            <span class="n">colors</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;glyph_color&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">):</span>
                <span class="n">color_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">scale_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">scale</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scale_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>

            <span class="c1"># Starting with Python 3.10 zip supports the &#39;strict&#39; keyword</span>
            <span class="c1"># argument. Helps to check consistency of points and vectors.</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">scalars</span><span class="o">.</span><span class="n">InsertNextTuple1</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">scale_</span><span class="p">))</span>
                <span class="n">colors</span><span class="o">.</span><span class="n">InsertNextTuple3</span><span class="p">(</span><span class="o">*</span><span class="nb">next</span><span class="p">(</span><span class="n">color_</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

            <span class="n">point_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span>
            <span class="n">point_data</span><span class="o">.</span><span class="n">SetVectors</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span><span class="p">))</span>
            <span class="n">point_data</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
            <span class="n">point_data</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
            <span class="n">point_data</span><span class="o">.</span><span class="n">SetActiveScalars</span><span class="p">(</span><span class="s1">&#39;glyph_scale&#39;</span><span class="p">)</span>

            <span class="n">glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="n">arrow</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">OrientOn</span><span class="p">()</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetVectorModeToUseVector</span><span class="p">()</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">ScalingOn</span><span class="p">()</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetScaleModeToScaleByScalar</span><span class="p">()</span>

            <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarModeToUsePointFieldData</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToDirectScalars</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">ScalarVisibilityOn</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SelectColorArray</span><span class="p">(</span><span class="s1">&#39;glyph_color&#39;</span><span class="p">)</span>

            <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">arrow_source</span><span class="p">(</span><span class="n">shaft_radius</span><span class="p">,</span> <span class="n">tip_radius</span><span class="p">,</span> <span class="n">tip_length</span><span class="p">,</span> <span class="n">resolution</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkArrowSource</span><span class="p">()</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipRadius</span><span class="p">(</span><span class="n">tip_radius</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipLength</span><span class="p">(</span><span class="n">tip_length</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetShaftRadius</span><span class="p">(</span><span class="n">shaft_radius</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetShaftResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">arrow</span>

    <span class="k">def</span> <span class="nf">modified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>





<div class="viewcode-block" id="OrientedGlyphs">
<a class="viewcode-back" href="../../api/m3sh.vis.OrientedGlyphs.html#m3sh.vis.OrientedGlyphs">[docs]</a>
<span class="k">class</span> <span class="nc">OrientedGlyphs</span><span class="p">(</span><span class="n">Prop</span><span class="p">,</span> <span class="n">PropertyMixin</span><span class="p">,</span> <span class="n">MapperMixin</span><span class="p">,</span> <span class="n">GlyphMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Glyph base class.</span>

<span class="sd">    Base class for all simple oriented glyphs. Displays a scaled and</span>
<span class="sd">    oriented `source` shape at all point locations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points : array_like</span>
<span class="sd">        Point coordinates.</span>
<span class="sd">    vectors : array_like</span>
<span class="sd">        Orientation defining vectors.</span>
<span class="sd">    source</span>
<span class="sd">        Source object.</span>
<span class="sd">    src_xform : vtkTransform</span>
<span class="sd">        Source transformation.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    If `array_like` parameters are of type :class:`~numpy.ndarray` their</span>
<span class="sd">    data buffer is shared with VTK&#39;s data objects (use copies to decouple</span>
<span class="sd">    storage).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">src_xform</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">Prop</span><span class="p">):</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">_vtk_polydata</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">GetData</span><span class="p">())</span>

            <span class="c1"># Normals should either be stored with the polydata instance</span>
            <span class="c1"># (vectors should be None in this case) or specified by the</span>
            <span class="c1"># vectors parameter (in this case the polydata should not</span>
            <span class="c1"># define normals).</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">normals</span> <span class="o">:=</span> <span class="n">points</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">GetNormals</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">vectors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ambiguous normal specification&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">normals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="n">normals</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">vectors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
                <span class="n">points</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetNormals</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vector</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;no normals specified&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">points</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="p">)</span>

            <span class="n">pointdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span>
            <span class="n">pointdata</span><span class="o">.</span><span class="n">SetNormals</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_source</span> <span class="o">=</span> <span class="n">source</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">OrientOn</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetVectorModeToUseNormal</span><span class="p">()</span>

        <span class="c1"># This allows scaling by the global scale factor but does not</span>
        <span class="c1"># use local scale factors associated with individual points.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetScaleModeToDataScalingOff</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">src_xform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetSourceTransform</span><span class="p">(</span><span class="n">src_xform</span><span class="p">)</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">_generic_lut</span><span class="p">(</span><span class="n">gradient</span><span class="o">=</span><span class="s1">&#39;spectral&#39;</span><span class="p">))</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetUseLookupTableScalarRange</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span></div>



<div class="viewcode-block" id="Spheres">
<a class="viewcode-back" href="../../api/m3sh.vis.Spheres.html#m3sh.vis.Spheres">[docs]</a>
<span class="k">class</span> <span class="nc">Spheres</span><span class="p">(</span><span class="n">Prop</span><span class="p">,</span> <span class="n">PropertyMixin</span><span class="p">,</span> <span class="n">MapperMixin</span><span class="p">,</span> <span class="n">GlyphMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Point cloud.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sphere</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetScaleModeToScaleByScalar</span><span class="p">()</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">_generic_lut</span><span class="p">(</span><span class="n">gradient</span><span class="o">=</span><span class="s1">&#39;spectral&#39;</span><span class="p">))</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_sphere</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">sphere</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkSphereSource</span><span class="p">()</span>

        <span class="n">sphere</span><span class="o">.</span><span class="n">SetPhiResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
        <span class="n">sphere</span><span class="o">.</span><span class="n">SetThetaResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sphere</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_cube</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCubeSource</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">style</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCubeSource</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;cubes&#39;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkSphereSource</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;spheres&#39;</span>

        <span class="k">return</span> <span class="s1">&#39;undefined&#39;</span>

    <span class="nd">@style</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;cubes&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cube</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;spheres&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sphere</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span></div>



<div class="viewcode-block" id="Arrows">
<a class="viewcode-back" href="../../api/m3sh.vis.Arrows.html#m3sh.vis.Arrows">[docs]</a>
<span class="k">class</span> <span class="nc">Arrows</span><span class="p">(</span><span class="n">OrientedGlyphs</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">shaft_radius</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                 <span class="n">tip_length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_arrow</span><span class="p">(</span><span class="n">shaft_radius</span><span class="p">,</span>
                                                       <span class="n">tip_radius</span><span class="p">,</span>
                                                       <span class="n">tip_length</span><span class="p">,</span>
                                                       <span class="n">resolution</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_arrow</span><span class="p">(</span><span class="n">shaft_radius</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tip_length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
               <span class="n">resolution</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkArrowSource</span><span class="p">()</span>

        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipRadius</span><span class="p">(</span><span class="n">tip_radius</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipLength</span><span class="p">(</span><span class="n">tip_length</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="n">arrow</span><span class="o">.</span><span class="n">SetShaftRadius</span><span class="p">(</span><span class="n">shaft_radius</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetShaftResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">arrow</span><span class="p">,</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="Circles">
<a class="viewcode-back" href="../../api/m3sh.vis.Circles.html#m3sh.vis.Circles">[docs]</a>
<span class="k">class</span> <span class="nc">Circles</span><span class="p">(</span><span class="n">OrientedGlyphs</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arc</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_arc</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
        <span class="n">arc</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkArcSource</span><span class="p">()</span>

        <span class="n">arc</span><span class="o">.</span><span class="n">SetCenter</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">SetNormal</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">SetPolarVector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">SetAngle</span><span class="p">(</span><span class="mf">360.0</span><span class="p">)</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">SetUseNormalAndAngle</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">SetResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">arc</span><span class="p">,</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">GetLineWidth</span><span class="p">()</span>

    <span class="nd">@width</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span>

    <span class="nd">@radius</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">style</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">GetRenderLinesAsTubes</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;tubes&#39;</span>

        <span class="k">return</span> <span class="s1">&#39;lines&#39;</span>

    <span class="nd">@style</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>



<div class="viewcode-block" id="Cones">
<a class="viewcode-back" href="../../api/m3sh.vis.Cones.html#m3sh.vis.Cones">[docs]</a>
<span class="k">class</span> <span class="nc">Cones</span><span class="p">(</span><span class="n">Prop</span><span class="p">,</span> <span class="n">PropertyMixin</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span>
                 <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="p">)</span>

        <span class="n">pointdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span>
        <span class="n">pointdata</span><span class="o">.</span><span class="n">SetVectors</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vectors</span><span class="p">))</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIntArray</span><span class="p">()</span>
        <span class="n">indices</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">indices</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">)):</span>
            <span class="n">indices</span><span class="o">.</span><span class="n">InsertNextTuple1</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>

        <span class="c1"># colors = vtk.vtkFloatArray()</span>
        <span class="c1"># colors.SetNumberOfComponents(3)</span>
        <span class="c1"># colors.SetName(&#39;color&#39;)</span>

        <span class="c1"># # for id in range(len(self._points)):</span>
        <span class="c1"># #     colors.InsertNextTuple1(id * 0.5)</span>

        <span class="c1"># colors.InsertNextTuple3(1.0, 0.0, 0.0)</span>
        <span class="c1"># colors.InsertNextTuple3(0.0, 1.0, 0.0)</span>
        <span class="c1"># colors.InsertNextTuple3(0.0, 0.0, 1.0)</span>

        <span class="c1"># self._vtk_polydata.GetPointData().AddArray(colors)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">height</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>

        <span class="n">prop</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPropAssembly</span><span class="p">()</span>
        <span class="n">prop</span><span class="o">.</span><span class="n">AddPart</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cones</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">double</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">AddPart</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cones</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cap</span><span class="p">,</span> <span class="n">resolution</span><span class="p">))</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">actor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Actor instance.</span>

<span class="sd">        Actor associated to the first part of the assembly.</span>

<span class="sd">        :type: vtkActor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetParts</span><span class="p">()</span>
        <span class="n">parts</span><span class="o">.</span><span class="n">InitTraversal</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">parts</span><span class="o">.</span><span class="n">GetNextProp</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Color property.</span>

<span class="sd">        Setting the global color attribute disables coloring using previously</span>
<span class="sd">        set scalars with :meth:`colorize`.</span>

<span class="sd">        :type: array_like, shape (3, )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">GetColor</span><span class="p">()</span>

    <span class="nd">@color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetParts</span><span class="p">():</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="Cones.colorize">
<a class="viewcode-back" href="../../api/m3sh.vis.Cones.colorize.html#m3sh.vis.Cones.colorize">[docs]</a>
    <span class="k">def</span> <span class="nf">colorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalars</span><span class="p">):</span>
        <span class="n">numpts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetNumberOfPoints</span><span class="p">()</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">numpts</span><span class="p">,</span> <span class="p">)</span> <span class="ow">or</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">numpts</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

            <span class="n">colors</span> <span class="o">=</span> <span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_colors</span><span class="p">)</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>

            <span class="c1"># This will replaces an array of the same name if present.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetParts</span><span class="p">():</span>
                <span class="n">mapper</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span>
                <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

                <span class="c1"># Direct colors is the array has 3 components, otherwise</span>
                <span class="c1"># map the scalars through the lookup table.</span>
                <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">numpts</span><span class="p">,</span> <span class="p">):</span>
                    <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToMapScalars</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToDirectScalars</span><span class="p">()</span></div>


<div class="viewcode-block" id="Cones.lookuptable">
<a class="viewcode-back" href="../../api/m3sh.vis.Cones.lookuptable.html#m3sh.vis.Cones.lookuptable">[docs]</a>
    <span class="k">def</span> <span class="nf">lookuptable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gradient</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Modify lookup table properties.</span>

<span class="sd">        An objects lookup tables determines how entries of the scalar array</span>
<span class="sd">        are translated to color values. Lookup tables have no effect when</span>
<span class="sd">        directly mapping RGB color values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        range : (float, float)</span>
<span class="sd">            Accpeted range of scalar values.</span>
<span class="sd">        gradient : str</span>
<span class="sd">            Color scheme identifier, see below.</span>
<span class="sd">        logscale : bool</span>
<span class="sd">            Switch between linear and logarithmic scale.</span>
<span class="sd">        size : int</span>
<span class="sd">            Size of lookup table.</span>

<span class="sd">        Keyword arguments</span>
<span class="sd">        -----------------</span>
<span class="sd">        below : array_like, shape (4, )</span>
<span class="sd">            Color for scalars below the specified range.</span>
<span class="sd">        above: array_like, shape (4, )</span>
<span class="sd">            Color for scalars above the specified range.</span>
<span class="sd">        nan : array_like, shape (4, )</span>
<span class="sd">            Special color for NaN scalar values.</span>


<span class="sd">        Smooth color gradients are defined by the color scheme identifiers</span>
<span class="sd">        &#39;hot&#39;, &#39;cool&#39;, &#39;jet&#39;, and &#39;grey&#39;. The color schemes &#39;spectral&#39;,</span>
<span class="sd">        &#39;diverging&#39;, &#39;blue&#39;, &#39;orange&#39;, and &#39;purple&#39; define a discrete color</span>
<span class="sd">        series.</span>

<span class="sd">        If provied, out of range values are marked with the `below`,</span>
<span class="sd">        `above`, and `nan` colors. Not that those colors also have an alpha</span>
<span class="sd">        intensity value to control opacity.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Arguments not provided have no affect on the corresponding lookup</span>
<span class="sd">        table property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetParts</span><span class="p">():</span>
            <span class="n">lut</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetLookupTable</span><span class="p">()</span>
            <span class="n">_tweak_lut</span><span class="p">(</span><span class="n">lut</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_cone</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">capping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
        <span class="n">cone</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkConeSource</span><span class="p">()</span>

        <span class="n">cone</span><span class="o">.</span><span class="n">SetHeight</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="n">cone</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="n">cone</span><span class="o">.</span><span class="n">SetCenter</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">height</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="n">cone</span><span class="o">.</span><span class="n">SetResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
        <span class="n">cone</span><span class="o">.</span><span class="n">SetCapping</span><span class="p">(</span><span class="n">capping</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cone</span>

    <span class="k">def</span> <span class="nf">_cones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">flip</span><span class="p">,</span> <span class="n">capping</span><span class="p">,</span> <span class="n">resolution</span><span class="p">):</span>
        <span class="n">glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
            <span class="n">cone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cone</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">capping</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
            <span class="n">glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">flip</span><span class="p">:</span>
            <span class="n">xform</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTransform</span><span class="p">()</span>
            <span class="n">xform</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
            <span class="n">xform</span><span class="o">.</span><span class="n">RotateY</span><span class="p">(</span><span class="mf">180.0</span><span class="p">)</span>

            <span class="n">glyph</span><span class="o">.</span><span class="n">SetSourceTransform</span><span class="p">(</span><span class="n">xform</span><span class="p">)</span>

        <span class="n">glyph</span><span class="o">.</span><span class="n">SetRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetIndexModeToScalar</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputArrayToProcess</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">)</span>

        <span class="n">glyph</span><span class="o">.</span><span class="n">SetColorModeToColorByScalar</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputArrayToProcess</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">)</span>

        <span class="n">glyph</span><span class="o">.</span><span class="n">ScalingOff</span><span class="p">()</span>

        <span class="n">glyph</span><span class="o">.</span><span class="n">OrientOn</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetVectorModeToUseVector</span><span class="p">()</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">_generic_lut</span><span class="p">(</span><span class="n">gradient</span><span class="o">=</span><span class="s1">&#39;spectral&#39;</span><span class="p">))</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetUseLookupTableScalarRange</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">actor</span></div>



<div class="viewcode-block" id="Disks">
<a class="viewcode-back" href="../../api/m3sh.vis.Disks.html#m3sh.vis.Disks">[docs]</a>
<span class="k">class</span> <span class="nc">Disks</span><span class="p">(</span><span class="n">OrientedGlyphs</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_disk</span><span class="p">())</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_disk</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
        <span class="n">disk</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkDiskSource</span><span class="p">()</span>

        <span class="n">disk</span><span class="o">.</span><span class="n">SetInnerRadius</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">disk</span><span class="o">.</span><span class="n">SetOuterRadius</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">disk</span><span class="o">.</span><span class="n">SetCircumferentialResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="n">xform</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTransform</span><span class="p">()</span>
        <span class="n">xform</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
        <span class="n">xform</span><span class="o">.</span><span class="n">RotateY</span><span class="p">(</span><span class="mf">90.0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">disk</span><span class="p">,</span> <span class="n">xform</span></div>



<span class="k">class</span> <span class="nc">__VectorField</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                 <span class="n">shaft_radius</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tip_length</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">resolution</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
        <span class="c1"># Prepare the data buffers used by VTK and fill them with the data</span>
        <span class="c1"># provided.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>

        <span class="n">scalars</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
        <span class="n">scalars</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">scalars</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;glyph_scale&#39;</span><span class="p">)</span>

        <span class="n">colors</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkFloatArray</span><span class="p">()</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">SetNumberOfComponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">SetName</span><span class="p">(</span><span class="s1">&#39;glyph_color&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">):</span>
            <span class="n">color_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">scale_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">scale</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scale_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>

        <span class="c1"># Starting with Python 3.10 zip supports the &#39;strict&#39; keyword argument.</span>
        <span class="c1"># Helps to check consistency of points and vectors argument.</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">vec</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">vec</span><span class="p">)):</span>
                <span class="n">scalars</span><span class="o">.</span><span class="n">InsertNextTuple1</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">scale_</span><span class="p">))</span>
                <span class="n">colors</span><span class="o">.</span><span class="n">InsertNextTuple3</span><span class="p">(</span><span class="o">*</span><span class="nb">next</span><span class="p">(</span><span class="n">color_</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetVectors</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">vectors</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">AddArray</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetActiveScalars</span><span class="p">(</span><span class="s1">&#39;glyph_scale&#39;</span><span class="p">)</span>

        <span class="c1"># The source shape used for glyphs. If rendering is too slow when there</span>
        <span class="c1"># is a large number of glyphs, the resolution of each can be reduced.</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkArrowSource</span><span class="p">()</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipRadius</span><span class="p">(</span><span class="n">tip_radius</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipLength</span><span class="p">(</span><span class="n">tip_length</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetTipResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetShaftRadius</span><span class="p">(</span><span class="n">shaft_radius</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">SetShaftResolution</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="n">glyph</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkGlyph3D</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="p">)</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetSourceConnection</span><span class="p">(</span><span class="n">arrow</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">OrientOn</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetVectorModeToUseVector</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">ScalingOn</span><span class="p">()</span>
        <span class="n">glyph</span><span class="o">.</span><span class="n">SetScaleModeToScaleByScalar</span><span class="p">()</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">glyph</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarModeToUsePointFieldData</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToDirectScalars</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">ScalarVisibilityOn</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SelectColorArray</span><span class="p">(</span><span class="s1">&#39;glyph_color&#39;</span><span class="p">)</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">modified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">_PolyData</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">GetData</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">verts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">verts</span><span class="p">:</span>
                    <span class="n">cells</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">SetVerts</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

            <span class="c1"># if lines is not None:</span>
            <span class="c1">#     cells = vtk.vtkCellArray()</span>
            <span class="c1">#     for i in range(len(edges) - 1):</span>
            <span class="c1">#         if lines[i] &gt; -1 and lines[i+1] &gt; -1:</span>
            <span class="c1">#             line = vtk.vtkIdList()</span>
            <span class="c1">#             line.InsertNextId(lines[i])</span>
            <span class="c1">#             line.InsertNextId(lines[i+1])</span>
            <span class="c1">#             cells.InsertNextCell(line)</span>
            <span class="c1">#     self._vtk_polydata.SetLines(cells)</span>

            <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
                    <span class="n">face</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                    <span class="n">cells</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">_generic_lut</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetUseLookupTableScalarRange</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Point coordinate array access.</span>

<span class="sd">        The contents of this array may be changed in place. Calling</span>
<span class="sd">        :meth:`modified` will update the visual representation on the</span>
<span class="sd">        next render pass.</span>

<span class="sd">        :type: ~numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">normals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">GetNormals</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">colorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalars</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gradient</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">logscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Colorize polygonal data.</span>

<span class="sd">        Colorize by assinging vertex colors or face colors. Vertex colors</span>
<span class="sd">        are interpolated across faces. Colors can be specified directly as</span>
<span class="sd">        RGB intensity triples or via a color map that maps scalar values</span>
<span class="sd">        to RGB values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scalars : ~numpy.ndarray</span>
<span class="sd">            Scalar values. Either one scalar per item or one RGB color</span>
<span class="sd">            triple per item.</span>
<span class="sd">        items : str</span>
<span class="sd">            Either &#39;points&#39; or &#39;cells&#39;.</span>
<span class="sd">        range : (float, float), optional</span>
<span class="sd">            Lookup table range. Defaults to the range given by the</span>
<span class="sd">            smallest and largest scalar value.</span>
<span class="sd">        gradient : str, optional</span>
<span class="sd">            Color scheme identifier.</span>
<span class="sd">        logscale : bool, optional</span>
<span class="sd">            Toggle logarithmic scaling.</span>
<span class="sd">        size : int, optional</span>
<span class="sd">            Size of lookup table.</span>


<span class="sd">        Mapping scalars to colors uses a lookup table managed by the</span>
<span class="sd">        :attr:`mapper` instance of an actor. The `range`, `gradient`, and</span>
<span class="sd">        `logscale` arguments directly influence the lookup table. Lookup</span>
<span class="sd">        tables can be further customized via the :meth:`lookuptable` method.</span>

<span class="sd">        Use the :func:`colorbar` function to display a visual representation</span>
<span class="sd">        of a lookup table.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        When specifying colors directly by RGB triples, all arguments</span>
<span class="sd">        except `scalars` and `items` are ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scalars</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">items</span> <span class="o">==</span> <span class="s1">&#39;points&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_point_scalars</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">items</span> <span class="o">==</span> <span class="s1">&#39;cells&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_cell_scalars</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid item argument &#39;</span><span class="si">{</span><span class="n">items</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">lookuptable</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reset_scalars</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Edge display.</span>

<span class="sd">        Set visual properties of edges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;lines&#39; or &#39;tubes&#39;. :obj:`False` to disable.</span>
<span class="sd">        width : int, optional</span>
<span class="sd">            Edge width in pixels.</span>
<span class="sd">        color : array_like, shape (3, ), optional</span>
<span class="sd">            Edge color.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        edge display property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">silhouette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Silhouette display.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;lines&#39; or &#39;tubes&#39;. :obj:`False` to disable.</span>
<span class="sd">        width : int, optional</span>
<span class="sd">            Edge width in pixels.</span>
<span class="sd">        color : array_like, shape (3, ), optional</span>
<span class="sd">            Edge color.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        silhouette display property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_silhouette&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outline</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataSilhouette</span><span class="p">()</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetCamera</span><span class="p">(</span><span class="n">_renderer</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">())</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetEnableFeatureAngle</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetBorderEdges</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">outline</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

            <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">black</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

            <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span> <span class="o">=</span> <span class="n">actor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">modified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_points</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_avg_edge_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkExtractEdges</span><span class="p">()</span>
        <span class="nb">filter</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>
        <span class="nb">filter</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

        <span class="n">points</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="nb">filter</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">()</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">GetData</span><span class="p">())</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">filter</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">()</span><span class="o">.</span><span class="n">GetLines</span><span class="p">()</span>
        <span class="n">edge_iter</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">NewIterator</span><span class="p">()</span>

        <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="nb">sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="n">edge_iter</span><span class="o">.</span><span class="n">IsDoneWithTraversal</span><span class="p">():</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="n">edge_iter</span><span class="o">.</span><span class="n">GetCurrentCell</span><span class="p">()</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">GetId</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">edge</span><span class="o">.</span><span class="n">GetId</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">length</span>

            <span class="nb">min</span> <span class="o">=</span> <span class="n">length</span> <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="nb">min</span> <span class="k">else</span> <span class="nb">min</span>
            <span class="nb">max</span> <span class="o">=</span> <span class="n">length</span> <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="nb">max</span> <span class="k">else</span> <span class="nb">max</span>

            <span class="n">edge_iter</span><span class="o">.</span><span class="n">GoToNextCell</span><span class="p">()</span>

        <span class="k">return</span> <span class="nb">sum</span> <span class="o">/</span> <span class="n">edges</span><span class="o">.</span><span class="n">GetNumberOfCells</span><span class="p">(),</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span>

    <span class="k">def</span> <span class="nf">_set_cell_scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_scalars</span><span class="p">(</span><span class="n">polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">(),</span>
                          <span class="n">polydata</span><span class="o">.</span><span class="n">GetNumberOfCells</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarModeToUseCellData</span><span class="p">()</span>


<div class="viewcode-block" id="PolyData">
<a class="viewcode-back" href="../../api/m3sh.vis.PolyData.html#m3sh.vis.PolyData">[docs]</a>
<span class="k">class</span> <span class="nc">PolyData</span><span class="p">(</span><span class="n">Prop</span><span class="p">,</span> <span class="n">PropertyMixin</span><span class="p">,</span> <span class="n">MapperMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Polygonal shape wrapper.</span>

<span class="sd">    Manages visual properties of a polygonal shape. If `data` is an</span>
<span class="sd">    `array_like` representation of a point set, it is converted to an</span>
<span class="sd">    equivalent :class:`~numpy.ndarray` instance. The created array is</span>
<span class="sd">    then accessible via the :attr:`points` attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like or vtkPolyData</span>
<span class="sd">        Point data.</span>
<span class="sd">    verts : list, optional</span>
<span class="sd">        Combinatorial vertex definitions.</span>
<span class="sd">    lines : list, optional</span>
<span class="sd">        Combinatorial line definitions.</span>
<span class="sd">    polys : list, optional</span>
<span class="sd">        Combinatorial face definitions.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The `verts`, `lines`, and `polys` arguments are ignored when</span>
<span class="sd">    `data` is a :class:`vtkPolyData` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">polys</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">GetData</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>

            <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
            <span class="n">points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">verts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">verts</span><span class="p">:</span>
                    <span class="n">cells</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span>

                <span class="n">polydata</span><span class="o">.</span><span class="n">SetVerts</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="n">edge</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>

                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">edge</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

                    <span class="n">cells</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>

                <span class="n">polydata</span><span class="o">.</span><span class="n">SetLines</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">polys</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">polys</span><span class="p">:</span>
                    <span class="n">face</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>

                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

                    <span class="n">cells</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>

                <span class="n">polydata</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>

        <span class="c1"># Create standard lookup table and how this table is used by</span>
        <span class="c1"># the mapper.</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">_generic_lut</span><span class="p">(</span><span class="n">gradient</span><span class="o">=</span><span class="s1">&#39;spectral&#39;</span><span class="p">))</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetUseLookupTableScalarRange</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="c1"># Initialize Prop base class. Mixins don&#39;t have an initializer.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>

        <span class="c1"># Initialize private properties.</span>
        <span class="c1"># self._draggable = None</span>
        <span class="c1"># self._scalars = None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Point coordinate array access.</span>

<span class="sd">        The contents of this array may be changed in place. Calling</span>
<span class="sd">        :meth:`modified` will update the visual representation on the</span>
<span class="sd">        next render pass.</span>

<span class="sd">        :type: ~numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Color property.</span>

<span class="sd">        Setting the global color attribute disables coloring using previously</span>
<span class="sd">        set scalars with :meth:`colorize`.</span>

<span class="sd">        :type: array_like, shape (3, )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">GetColor</span><span class="p">()</span>

    <span class="nd">@color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="PolyData.colorize">
<a class="viewcode-back" href="../../api/m3sh.vis.PolyData.colorize.html#m3sh.vis.PolyData.colorize">[docs]</a>
    <span class="k">def</span> <span class="nf">colorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalars</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">interpolate_scalars</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot; Colorize polygonal data.</span>

<span class="sd">        Colorize by assinging vertex colors or face colors. Vertex colors</span>
<span class="sd">        are interpolated across faces. Colors can be specified directly as</span>
<span class="sd">        RGB intensity triples or via a color map that maps scalar values</span>
<span class="sd">        to colors (see :meth:`lookuptable` for details on the mapping).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scalars : array_like</span>
<span class="sd">            Scalar values.</span>
<span class="sd">        items : str</span>
<span class="sd">            Either &#39;verts&#39; or &#39;cells&#39;.</span>


<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Use the :func:`colorbar` function to display a visual representation</span>
<span class="sd">        of the lookup table used for color mapping.</span>


<span class="sd">        .. rubric:: Examples</span>

<span class="sd">        Apply colors to the vertices of the unit cube :math:`[0, 1]^3`.</span>
<span class="sd">        Since vertex coordinates range between 0 and 1 we use them directly</span>
<span class="sd">        as RGB color specification.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :linenos:</span>

<span class="sd">           import m3sh.vis as vis</span>

<span class="sd">           box = vis.box([0., 0., 0.], [1., 1., 1.])</span>
<span class="sd">           box.edges()</span>
<span class="sd">           box.colorize(box.points, &#39;verts&#39;)</span>

<span class="sd">           vis.show()</span>


<span class="sd">        Color the cube by :math:`z`-coordinate value. Not the difference</span>
<span class="sd">        when interpolating scalars before mapping them to colors.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :linenos:</span>

<span class="sd">           import m3sh.vis as vis</span>

<span class="sd">           box = vis.box([0., 0., 0.], [1., 1., 1.])</span>
<span class="sd">           box.edges()</span>
<span class="sd">           box.colorize(box.points[:, 2], &#39;verts&#39;, interpolate_scalars=True)</span>

<span class="sd">           vis.colorbar(box)</span>
<span class="sd">           vis.show()</span>


<span class="sd">        To map colors to faces we have to specify a scalar for each of the</span>
<span class="sd">        six faces of the cube. Note that the `interpolate_scalars` argument</span>
<span class="sd">        has no effect when mapping colors to faces.</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">           :linenos:</span>

<span class="sd">           import m3sh.vis as vis</span>

<span class="sd">           box = vis.box([0., 0., 0.], [1., 1., 1.])</span>
<span class="sd">           box.edges()</span>
<span class="sd">           box.colorize([.0, .2, .4, .6, .8, 1.], &#39;cells&#39;)</span>

<span class="sd">           vis.colorbar(box)</span>
<span class="sd">           vis.show()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">items</span> <span class="o">==</span> <span class="s1">&#39;verts&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_point_scalars</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">items</span> <span class="o">==</span> <span class="s1">&#39;cells&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_cell_scalars</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid item argument &#39;</span><span class="si">{</span><span class="n">items</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetInterpolateScalarsBeforeMapping</span><span class="p">(</span>
            <span class="n">interpolate_scalars</span><span class="p">)</span></div>


    <span class="c1"># def contour(self, scalars=None, *, levels=None, range=(None, None),</span>
    <span class="c1">#             width=None, style=None, color=None):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if scalars is None and self._scalars is None:</span>
    <span class="c1">#         raise ValueError(&quot;required argument &#39;scalars&#39; is missing&quot;)</span>

    <span class="c1">#     if scalars is not None:</span>
    <span class="c1">#         self._set_point_scalars(scalars)</span>

    <span class="c1">#     if not hasattr(self, &#39;_contour&#39;):</span>
    <span class="c1">#         self._contour = None</span>

    <span class="c1">#     if style == &#39;&#39;:</span>
    <span class="c1">#         delete(self._contour)</span>
    <span class="c1">#         self._contour = None</span>
    <span class="c1">#         return</span>

    <span class="c1">#     if self._contour is None:</span>
    <span class="c1">#         lo = self._scalars.min() if range[0] is None else range[0]</span>
    <span class="c1">#         hi = self._scalars.max() if range[1] is None else range[1]</span>

    <span class="c1">#         curves = vtk.vtkContourFilter()</span>
    <span class="c1">#         curves.SetInputData(self._vtk_polydata)</span>
    <span class="c1">#         curves.GenerateValues(levels, lo, hi)</span>

    <span class="c1">#         mapper = vtk.vtkPolyDataMapper()</span>
    <span class="c1">#         mapper.SetInputConnection(curves.GetOutputPort())</span>

    <span class="c1">#         actor = vtk.vtkActor()</span>
    <span class="c1">#         actor.SetMapper(mapper)</span>
    <span class="c1">#         actor.SetPickable(False)</span>

    <span class="c1">#         add(actor)</span>
    <span class="c1">#         self._contour = actor</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         actor = self._contour</span>

    <span class="c1">#     if width is not None:</span>
    <span class="c1">#         actor.GetProperty().SetLineWidth(width)</span>

    <span class="c1">#     if style == &#39;lines&#39;:</span>
    <span class="c1">#         actor.GetProperty().SetRenderLinesAsTubes(False)</span>
    <span class="c1">#     elif style == &#39;tubes&#39;:</span>
    <span class="c1">#         actor.GetProperty().SetRenderLinesAsTubes(True)</span>

    <span class="c1">#     if color == &#39;scalars&#39;:</span>
    <span class="c1">#         mapper.SetColorModeToMapScalars()</span>
    <span class="c1">#         mapper.SetLookupTable(self.mapper.GetLookupTable())</span>
    <span class="c1">#         mapper.SetUseLookupTableScalarRange(True)</span>
    <span class="c1">#         mapper.SetScalarVisibility(True)</span>
    <span class="c1">#     elif color is not None:</span>
    <span class="c1">#         mapper.SetScalarVisibility(False)</span>
    <span class="c1">#         actor.GetProperty().SetColor(color)</span>

    <span class="c1"># def verts(self, style=None, size=None, color=None):</span>
    <span class="c1">#     &quot;&quot;&quot; Vertex display.</span>

    <span class="c1">#     Set visual properties of vertices.</span>

    <span class="c1">#     Parameters</span>
    <span class="c1">#     ----------</span>
    <span class="c1">#     style : str, optional</span>
    <span class="c1">#         Either &#39;points&#39; or &#39;spheres&#39;, :obj:`False` to disable.</span>
    <span class="c1">#     size : int, optional</span>
    <span class="c1">#         Size in pixels.</span>
    <span class="c1">#     color : array_like, shape (3, ), optional</span>
    <span class="c1">#         Vertex color.</span>

    <span class="c1">#     Note</span>
    <span class="c1">#     ----</span>
    <span class="c1">#     Parameters with a :obj:`None` value do not affect the corresponding</span>
    <span class="c1">#     vertex display property.</span>

    <span class="c1">#     Important</span>
    <span class="c1">#     ---------</span>
    <span class="c1">#     On some rendering backends vertex display only works when edges</span>
    <span class="c1">#     are displayed. For now use :func:`scatter` as a work-around.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if style == &#39;points&#39;:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetRenderPointsAsSpheres(False)</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetVertexVisibility(True)</span>
    <span class="c1">#     elif style == &#39;spheres&#39;:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetRenderPointsAsSpheres(True)</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetVertexVisibility(True)</span>
    <span class="c1">#     elif style == &#39;&#39; or style is False:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetVertexVisibility(False)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetVertexVisibility(True)</span>

    <span class="c1">#     if size is not None:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetPointSize(size)</span>

    <span class="c1">#     if color is not None:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetVertexColor(color)</span>

    <span class="c1"># def edges(self, style=None, width=None, color=None):</span>
    <span class="c1">#     &quot;&quot;&quot; Edge display.</span>

    <span class="c1">#     Set visual properties of edges.</span>

    <span class="c1">#     Parameters</span>
    <span class="c1">#     ----------</span>
    <span class="c1">#     style : str, optional</span>
    <span class="c1">#         Either &#39;lines&#39; or &#39;tubes&#39;, :obj:`False` to disable.</span>
    <span class="c1">#     width : int, optional</span>
    <span class="c1">#         Edge width in pixels.</span>
    <span class="c1">#     color : array_like, shape (3, ), optional</span>
    <span class="c1">#         Edge color.</span>

    <span class="c1">#     Note</span>
    <span class="c1">#     ----</span>
    <span class="c1">#     Parameters with a :obj:`None` value do not affect the corresponding</span>
    <span class="c1">#     edge display property.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if style == &#39;lines&#39;:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetRenderLinesAsTubes(False)</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetEdgeVisibility(True)</span>
    <span class="c1">#     elif style == &#39;tubes&#39;:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetRenderLinesAsTubes(True)</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetEdgeVisibility(True)</span>
    <span class="c1">#     elif style == &#39;&#39; or style is False:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetEdgeVisibility(False)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetEdgeVisibility(True)</span>

    <span class="c1">#     if width is not None:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetLineWidth(width)</span>

    <span class="c1">#     if color is not None:</span>
    <span class="c1">#         self._vtk_prop.GetProperty().SetEdgeColor(color)</span>

<div class="viewcode-block" id="PolyData.modified">
<a class="viewcode-back" href="../../api/m3sh.vis.PolyData.modified.html#m3sh.vis.PolyData.modified">[docs]</a>
    <span class="k">def</span> <span class="nf">modified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Update notification.</span>

<span class="sd">        Should be called when the contents of a shared data buffer are</span>
<span class="sd">        modified.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Changing the **shape** of a shared data buffer is likely to</span>
<span class="sd">        result in a segmentation fault or other undefined behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_set_point_scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span>
        <span class="n">polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_scalars</span><span class="p">(</span><span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">(),</span>
                          <span class="n">polydata</span><span class="o">.</span><span class="n">GetNumberOfPoints</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarModeToUsePointData</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_cell_scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span>
        <span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_scalars</span><span class="p">(</span><span class="n">polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">(),</span>
                          <span class="n">polydata</span><span class="o">.</span><span class="n">GetNumberOfCells</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarModeToUseCellData</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">mapper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">data</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span><span class="p">))</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToMapScalars</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">data</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span><span class="p">))</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToDirectScalars</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;wrong size of scalar array&#39;</span><span class="p">)</span></div>


    <span class="c1"># def _reset_scalars(self):</span>
    <span class="c1">#     polydata = self._prop.GetMapper().GetInput()</span>

    <span class="c1">#     data = polydata.GetPointData()</span>
    <span class="c1">#     data.SetScalars(None)</span>
    <span class="c1">#     data.Modified()</span>

    <span class="c1">#     data = polydata.GetCellData()</span>
    <span class="c1">#     data.SetScalars(None)</span>
    <span class="c1">#     data.Modified()</span>

    <span class="c1">#     self._prop.GetMapper().SetScalarVisibility(False)</span>
    <span class="c1">#     self._scalars = None</span>


<span class="k">class</span> <span class="nc">__PolyData</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Polygonal shape wrapper.</span>

<span class="sd">    Manages visual properties of a polygonal shape. Point clouds are</span>
<span class="sd">    polygonal shapes that only define 0-dimensional cells. If `data`</span>
<span class="sd">    is an `array_like` representation of a point set, it is converted</span>
<span class="sd">    to an equivalent :class:`~numpy.ndarray` instance. The created</span>
<span class="sd">    array is then accessible via the :attr:`points` attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array_like or vtkPolyData</span>
<span class="sd">        Point data.</span>
<span class="sd">    verts : list, optional</span>
<span class="sd">        Combinatorial vertex definitions.</span>
<span class="sd">    lines : list, optional</span>
<span class="sd">        Not supported yet.</span>
<span class="sd">    faces : list, optional</span>
<span class="sd">        Combinatorial face definitions.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The `verts`, `lines`, and `faces` arguments are ignored when</span>
<span class="sd">    `data` is a :class:`vtkPolyData` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">GetData</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>

            <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
            <span class="n">points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">))</span>

            <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span>
            <span class="n">polydata</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">verts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">verts</span><span class="p">:</span>
                    <span class="n">cells</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span>
                <span class="n">polydata</span><span class="o">.</span><span class="n">SetVerts</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

            <span class="c1"># if lines is not None:</span>
            <span class="c1">#     cells = vtk.vtkCellArray()</span>

            <span class="c1">#     for i in range(len(edges) - 1):</span>
            <span class="c1">#         if lines[i] &gt; -1 and lines[i+1] &gt; -1:</span>
            <span class="c1">#             line = vtk.vtkIdList()</span>
            <span class="c1">#             line.InsertNextId(lines[i])</span>
            <span class="c1">#             line.InsertNextId(lines[i+1])</span>
            <span class="c1">#             cells.InsertNextCell(line)</span>

            <span class="c1">#     polydata.SetLines(cells)</span>

            <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
                    <span class="n">face</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">face</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                    <span class="n">cells</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
                <span class="n">polydata</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span><span class="p">)</span>

        <span class="c1"># Create standard lookup table and how this table is used</span>
        <span class="c1"># by the mapper.</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">_generic_lut</span><span class="p">())</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetUseLookupTableScalarRange</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="c1"># Initialize base class.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>

        <span class="c1"># Initialize private properties.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draggable</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Point coordinate array access.</span>

<span class="sd">        The contents of this array may be changed in place. Calling</span>
<span class="sd">        :meth:`modified` will update the visual representation on the</span>
<span class="sd">        next render pass.</span>

<span class="sd">        :type: ~numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_points</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">polydata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Data access.</span>

<span class="sd">        Access VTK&#39;s polygonal shape definition.</span>

<span class="sd">        :type: vtkPolyData</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_polydata</span>
        <span class="c1"># return self._prop.GetMapper().GetInput()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Color property.</span>

<span class="sd">        Setting the global color attribute disables coloring using previously</span>
<span class="sd">        set scalars with :meth:`colorize`.</span>

<span class="sd">        :type: array_like, shape (3, )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">GetColor</span><span class="p">()</span>

    <span class="nd">@color</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Scalar access.</span>

<span class="sd">        Access scalar data set by the :meth:`colorize` method.</span>

<span class="sd">        :type: ~numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modified</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span>

    <span class="c1"># @property</span>
    <span class="c1"># def draggable(self):</span>
    <span class="c1">#     return self._draggable</span>

    <span class="c1"># @draggable.setter</span>
    <span class="c1"># def draggable(self, value):</span>
    <span class="c1">#     self._draggable = value</span>

    <span class="k">def</span> <span class="nf">colorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalars</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gradient</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">logscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Colorize polygonal data.</span>

<span class="sd">        Colorize by assinging vertex colors or face colors. Vertex colors</span>
<span class="sd">        are interpolated across faces. Colors can be specified directly as</span>
<span class="sd">        RGB intensity triples or via a color map that maps scalar values</span>
<span class="sd">        to RGB values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scalars : ~numpy.ndarray</span>
<span class="sd">            Scalar values. Either one scalar per item or one RGB color</span>
<span class="sd">            triple per item.</span>
<span class="sd">        items : str</span>
<span class="sd">            Either &#39;points&#39; or &#39;cells&#39;.</span>
<span class="sd">        range : (float, float), optional</span>
<span class="sd">            Lookup table range. Defaults to the range given by the</span>
<span class="sd">            smallest and largest scalar value.</span>
<span class="sd">        gradient : str, optional</span>
<span class="sd">            Color scheme identifier.</span>
<span class="sd">        logscale : bool, optional</span>
<span class="sd">            Toggle logarithmic scaling.</span>
<span class="sd">        size : int, optional</span>
<span class="sd">            Size of lookup table.</span>


<span class="sd">        Mapping scalars to colors uses a lookup table managed by the</span>
<span class="sd">        :attr:`mapper` instance of an actor. The `range`, `gradient`, and</span>
<span class="sd">        `logscale` arguments directly influence the lookup table. Lookup</span>
<span class="sd">        tables can be further customized via the :meth:`lookuptable` method.</span>

<span class="sd">        Use the :func:`colorbar` function to display a visual representation</span>
<span class="sd">        of a lookup table.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        When specifying colors directly by RGB triples, all arguments</span>
<span class="sd">        except `scalars` and `items` are ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scalars</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">items</span> <span class="o">==</span> <span class="s1">&#39;points&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_point_scalars</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">items</span> <span class="o">==</span> <span class="s1">&#39;cells&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_cell_scalars</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid item argument &#39;</span><span class="si">{</span><span class="n">items</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">lookuptable</span><span class="p">(</span><span class="nb">range</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">logscale</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     self._reset_scalars()</span>

    <span class="k">def</span> <span class="nf">verts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Vertex display.</span>

<span class="sd">        Set visual properties of vertices.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;points&#39; or &#39;spheres&#39;. :obj:`False` to disable.</span>
<span class="sd">        size : int, optional</span>
<span class="sd">            Size in pixels.</span>
<span class="sd">        color : array_like, shape (3, ), optional</span>
<span class="sd">            Vertex color.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        vertex display property.</span>

<span class="sd">        Important</span>
<span class="sd">        ---------</span>
<span class="sd">        On some rendering backends vertex display only works when edges</span>
<span class="sd">        are displayed. This might get fixed in future VTK releases. For</span>
<span class="sd">        now use :func:`scatter` as a work-around.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;points&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderPointsAsSpheres</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;spheres&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderPointsAsSpheres</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetPointSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Edge display.</span>

<span class="sd">        Set visual properties of edges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;lines&#39; or &#39;tubes&#39;. :obj:`False` to disable.</span>
<span class="sd">        width : int, optional</span>
<span class="sd">            Edge width in pixels.</span>
<span class="sd">        color : array_like, shape (3, ), optional</span>
<span class="sd">            Edge color.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        edge display property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">silhouette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Silhouette display.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;lines&#39; or &#39;tubes&#39;. :obj:`False` to disable.</span>
<span class="sd">        width : int, optional</span>
<span class="sd">            Edge width in pixels.</span>
<span class="sd">        color : array_like, shape (3, ), optional</span>
<span class="sd">            Edge color.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        silhouette display property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_silhouette&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outline</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataSilhouette</span><span class="p">()</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polydata</span><span class="p">)</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetCamera</span><span class="p">(</span><span class="n">_renderer</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">())</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetEnableFeatureAngle</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">outline</span><span class="o">.</span><span class="n">SetBorderEdges</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">outline</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

            <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">black</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

            <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span> <span class="o">=</span> <span class="n">actor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_silhouette</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">modified</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Update notification.</span>

<span class="sd">        Should be called when the contents of a shared data buffer are</span>
<span class="sd">        modified.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Changing the **shape** of a shared data buffer is likely to</span>
<span class="sd">        result in a segmentation fault or other undefined behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

        <span class="c1"># There are cells that define vertices and lines. None of the</span>
        <span class="c1"># wrapped shapes use them.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span><span class="o">.</span><span class="n">GetPolys</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_point_scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_scalars</span><span class="p">(</span><span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">(),</span>
                          <span class="n">polydata</span><span class="o">.</span><span class="n">GetNumberOfPoints</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarModeToUsePointData</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_cell_scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_scalars</span><span class="p">(</span><span class="n">polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">(),</span>
                          <span class="n">polydata</span><span class="o">.</span><span class="n">GetNumberOfCells</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarModeToUseCellData</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set scalar array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data :</span>
<span class="sd">        size :</span>
<span class="sd">        value : ~numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mapper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">data</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span><span class="p">))</span>
            <span class="n">data</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

            <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToMapScalars</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">data</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span><span class="p">))</span>
            <span class="n">data</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

            <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToDirectScalars</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;wrong size of scalar array&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_reset_scalars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">polydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">polydata</span><span class="o">.</span><span class="n">GetCellData</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">SetScalars</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_prop</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">class</span> <span class="nc">_PolyMesh</span><span class="p">(</span><span class="n">PolyData</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Polygonal mesh shape.</span>

<span class="sd">    Wrapper class managing the visual properties of a mesh. Instances of</span>
<span class="sd">    this class are typically generated using the :func:`mesh` function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mesh : Mesh or tuple</span>
<span class="sd">        Polygonal mesh representation.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        When `copy` evaluates to :obj:`False` and a copy cannot be</span>
<span class="sd">        avoided, e.g., when vertex coordinates are represented as a</span>
<span class="sd">        nested list of floating point values.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The generated :class:`PolyMesh` instance and `mesh` share their</span>
<span class="sd">    vertex coordinate data buffers if not disabled explicitly.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">faces</span><span class="o">=</span><span class="n">mesh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Initialize private properties.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mesh</span> <span class="o">=</span> <span class="n">mesh</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Mesh access.</span>

<span class="sd">        :type: Mesh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mesh</span>

    <span class="k">def</span> <span class="nf">texture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">uv</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Texture mapping.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        img : str</span>
<span class="sd">            Name of image file.</span>
<span class="sd">        uv : ~numpy.ndarray</span>
<span class="sd">            Texture coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">SetTCoords</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="n">uv</span><span class="p">))</span>

        <span class="n">factory</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageReader2Factory</span><span class="p">()</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">CreateImageReader2</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">SetFileName</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">reader</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

        <span class="n">texture</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTexture</span><span class="p">()</span>
        <span class="n">texture</span><span class="o">.</span><span class="n">InterpolateOn</span><span class="p">()</span>
        <span class="n">texture</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">SetTexture</span><span class="p">(</span><span class="n">texture</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scalars</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;required argument &#39;scalars&#39; is missing&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">scalars</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_point_scalars</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_contour&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contour</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_contour</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contour</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contour</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">if</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">hi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scalars</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">if</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">curves</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkContourFilter</span><span class="p">()</span>
            <span class="n">curves</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polydata</span><span class="p">)</span>
            <span class="n">curves</span><span class="o">.</span><span class="n">GenerateValues</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">)</span>

            <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">curves</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

            <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">SetPickable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">add</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contour</span> <span class="o">=</span> <span class="n">actor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contour</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;scalars&#39;</span><span class="p">:</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToMapScalars</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapper</span><span class="o">.</span><span class="n">GetLookupTable</span><span class="p">())</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetUseLookupTableScalarRange</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>


<div class="viewcode-block" id="PolyMesh">
<a class="viewcode-back" href="../../api/m3sh.vis.PolyMesh.html#m3sh.vis.PolyMesh">[docs]</a>
<span class="k">class</span> <span class="nc">PolyMesh</span><span class="p">(</span><span class="n">PolyData</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Polygonal mesh shape.</span>

<span class="sd">    Wrapper class managing the visual properties of a mesh. Instances of</span>
<span class="sd">    this class are typically generated using the :func:`mesh` function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mesh : Mesh or tuple</span>
<span class="sd">        Polygonal mesh representation.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The generated :class:`PolyMesh` instance and `mesh` share their</span>
<span class="sd">    vertex coordinate data buffers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

            <span class="c1"># There is not halfedge mesh instance when initializing from</span>
            <span class="c1"># a vtkPolyData instance.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mesh</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">normals</span> <span class="o">:=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span><span class="o">.</span><span class="n">GetNormals</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="n">normals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># We rely on the __getitem__ method of the Mesh class to get</span>
            <span class="c1"># the array of point coordintaes and an iterable that can be</span>
            <span class="c1"># treated as list[list[int]] to specify mesh connectivity.</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">polys</span><span class="o">=</span><span class="n">mesh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># Initialize private instance attributes. Can be accessed as</span>
            <span class="c1"># properties of the same name.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mesh</span> <span class="o">=</span> <span class="n">mesh</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Mesh access.</span>

<span class="sd">        :type: Mesh</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mesh</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">normals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Vertex normals.</span>

<span class="sd">        Vertex normals are merely a visualization hint and result in</span>
<span class="sd">        smooth shading of the mesh.</span>

<span class="sd">        :type: ~numpy.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span>

    <span class="nd">@normals</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">normals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="o">.</span><span class="n">GetPointData</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_normals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_normals</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">data</span><span class="o">.</span><span class="n">SetNormals</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="PolyMesh.verts">
<a class="viewcode-back" href="../../api/m3sh.vis.PolyMesh.verts.html#m3sh.vis.PolyMesh.verts">[docs]</a>
    <span class="k">def</span> <span class="nf">verts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Vertex display.</span>

<span class="sd">        Set visual properties of vertices.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;points&#39; or &#39;spheres&#39;, :obj:`False` to disable.</span>
<span class="sd">        size : int, optional</span>
<span class="sd">            Size in pixels.</span>
<span class="sd">        color : array_like, shape (3, ), optional</span>
<span class="sd">            Vertex color.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        vertex display property.</span>

<span class="sd">        Important</span>
<span class="sd">        ---------</span>
<span class="sd">        On some rendering backends vertex display only works when edges</span>
<span class="sd">        are displayed. For now use :func:`scatter` as a work-around.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;points&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderPointsAsSpheres</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;spheres&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderPointsAsSpheres</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetPointSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetVertexColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span></div>


<div class="viewcode-block" id="PolyMesh.edges">
<a class="viewcode-back" href="../../api/m3sh.vis.PolyMesh.edges.html#m3sh.vis.PolyMesh.edges">[docs]</a>
    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Edge display.</span>

<span class="sd">        Set visual properties of edges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;lines&#39; or &#39;tubes&#39;, :obj:`False` to disable.</span>
<span class="sd">        width : int, optional</span>
<span class="sd">            Edge width in pixels.</span>
<span class="sd">        color : array_like, shape (3, ), optional</span>
<span class="sd">            Edge color.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        edge display property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span></div>


    <span class="c1"># def texture(self, img, uv):</span>
    <span class="c1">#     &quot;&quot;&quot; Texture mapping.</span>

    <span class="c1">#     Parameters</span>
    <span class="c1">#     ----------</span>
    <span class="c1">#     img : str</span>
    <span class="c1">#         Name of image file.</span>
    <span class="c1">#     uv : ~numpy.ndarray</span>
    <span class="c1">#         Texture coordinates.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     self.polydata.GetPointData().SetTCoords(numpy_to_vtk(uv))</span>

    <span class="c1">#     factory = vtk.vtkImageReader2Factory()</span>
    <span class="c1">#     reader = factory.CreateImageReader2(img)</span>
    <span class="c1">#     reader.SetFileName(img)</span>
    <span class="c1">#     reader.Update()</span>

    <span class="c1">#     texture = vtk.vtkTexture()</span>
    <span class="c1">#     texture.InterpolateOn()</span>
    <span class="c1">#     texture.SetInputConnection(reader.GetOutputPort())</span>

    <span class="c1">#     self.prop.SetTexture(texture)</span>

    <span class="c1"># def contour(self, scalars=None, *, levels=None, range=(None, None),</span>
    <span class="c1">#             width=None, style=None, color=None):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if scalars is None and self._scalars is None:</span>
    <span class="c1">#         raise ValueError(&quot;required argument &#39;scalars&#39; is missing&quot;)</span>

    <span class="c1">#     if scalars is not None:</span>
    <span class="c1">#         self._set_point_scalars(scalars)</span>

    <span class="c1">#     if not hasattr(self, &#39;_contour&#39;):</span>
    <span class="c1">#         self._contour = None</span>

    <span class="c1">#     if style == &#39;&#39;:</span>
    <span class="c1">#         delete(self._contour)</span>
    <span class="c1">#         self._contour = None</span>
    <span class="c1">#         return</span>

    <span class="c1">#     if self._contour is None:</span>
    <span class="c1">#         lo = self._scalars.min() if range[0] is None else range[0]</span>
    <span class="c1">#         hi = self._scalars.max() if range[1] is None else range[1]</span>

    <span class="c1">#         curves = vtk.vtkContourFilter()</span>
    <span class="c1">#         curves.SetInputData(self._vtk_polydata)</span>
    <span class="c1">#         curves.GenerateValues(levels, lo, hi)</span>

    <span class="c1">#         mapper = vtk.vtkPolyDataMapper()</span>
    <span class="c1">#         mapper.SetInputConnection(curves.GetOutputPort())</span>

    <span class="c1">#         actor = vtk.vtkActor()</span>
    <span class="c1">#         actor.SetMapper(mapper)</span>
    <span class="c1">#         actor.SetPickable(False)</span>

    <span class="c1">#         add(actor)</span>
    <span class="c1">#         self._contour = actor</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         actor = self._contour</span>

    <span class="c1">#     if width is not None:</span>
    <span class="c1">#         actor.GetProperty().SetLineWidth(width)</span>

    <span class="c1">#     if style == &#39;lines&#39;:</span>
    <span class="c1">#         actor.GetProperty().SetRenderLinesAsTubes(False)</span>
    <span class="c1">#     elif style == &#39;tubes&#39;:</span>
    <span class="c1">#         actor.GetProperty().SetRenderLinesAsTubes(True)</span>

    <span class="c1">#     if color == &#39;scalars&#39;:</span>
    <span class="c1">#         mapper.SetColorModeToMapScalars()</span>
    <span class="c1">#         mapper.SetLookupTable(self.mapper.GetLookupTable())</span>
    <span class="c1">#         mapper.SetUseLookupTableScalarRange(True)</span>
    <span class="c1">#         mapper.SetScalarVisibility(True)</span>
    <span class="c1">#     elif color is not None:</span>
    <span class="c1">#         mapper.SetScalarVisibility(False)</span>
    <span class="c1">#         actor.GetProperty().SetColor(color)</span>

    <span class="k">def</span> <span class="nf">_avg_edge_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># The edge extraction filter only works when there are polygonal</span>
        <span class="c1"># cells defined! This cannot be used to compute the average edge</span>
        <span class="c1"># length of a PolyGraph instance!</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkExtractEdges</span><span class="p">()</span>
        <span class="nb">filter</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_polydata</span><span class="p">)</span>
        <span class="nb">filter</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

        <span class="n">points</span> <span class="o">=</span> <span class="n">vtk_to_numpy</span><span class="p">(</span><span class="nb">filter</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">()</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span><span class="o">.</span><span class="n">GetData</span><span class="p">())</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">filter</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">()</span><span class="o">.</span><span class="n">GetLines</span><span class="p">()</span>
        <span class="n">edge_iter</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">NewIterator</span><span class="p">()</span>

        <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="nb">sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="n">edge_iter</span><span class="o">.</span><span class="n">IsDoneWithTraversal</span><span class="p">():</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="n">edge_iter</span><span class="o">.</span><span class="n">GetCurrentCell</span><span class="p">()</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">edge</span><span class="o">.</span><span class="n">GetId</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">edge</span><span class="o">.</span><span class="n">GetId</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:])</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">length</span>

            <span class="nb">min</span> <span class="o">=</span> <span class="n">length</span> <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="nb">min</span> <span class="k">else</span> <span class="nb">min</span>
            <span class="nb">max</span> <span class="o">=</span> <span class="n">length</span> <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="nb">max</span> <span class="k">else</span> <span class="nb">max</span>

            <span class="n">edge_iter</span><span class="o">.</span><span class="n">GoToNextCell</span><span class="p">()</span>

        <span class="k">return</span> <span class="nb">sum</span> <span class="o">/</span> <span class="n">edges</span><span class="o">.</span><span class="n">GetNumberOfCells</span><span class="p">(),</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span></div>



<div class="viewcode-block" id="PolyGraph">
<a class="viewcode-back" href="../../api/m3sh.vis.PolyGraph.html#m3sh.vis.PolyGraph">[docs]</a>
<span class="k">class</span> <span class="nc">PolyGraph</span><span class="p">(</span><span class="n">PolyData</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Polygonal graph.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nodes : array_like</span>
<span class="sd">        Node coordinate array.</span>
<span class="sd">    graph : csr_matrix</span>
<span class="sd">        Combinatorial graph definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># def __init__(self, points, graph):</span>
    <span class="c1">#     super().__init__(points, lines=graph.edges())</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">graph</span><span class="p">):</span>
        <span class="c1"># Raises an attribute error if not a sparse matrix or array type.</span>
        <span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s1">&#39;csr&#39;</span>

        <span class="c1"># Assume csr_matrix representation of graph, i.e., edge defined by</span>
        <span class="c1"># the sparsity pattern, not by edge weights!</span>
        <span class="n">rowptr</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">indptr</span>
        <span class="n">colidx</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">indices</span>

        <span class="c1"># For a symmetric matrix this will define all edges twice! Fix!</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rowptr</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">colidx</span><span class="p">[</span><span class="n">rowptr</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">rowptr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="n">edges</span><span class="p">)</span>

        <span class="c1"># mapper = self._vtk_prop.GetMapper()</span>
        <span class="c1"># mapper.SetResolveCoincidentTopologyToPolygonOffset()</span>

<div class="viewcode-block" id="PolyGraph.edges">
<a class="viewcode-back" href="../../api/m3sh.vis.PolyGraph.edges.html#m3sh.vis.PolyGraph.edges">[docs]</a>
    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Edge display.</span>

<span class="sd">        Set visual properties of edges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;lines&#39; or &#39;tubes&#39;.</span>
<span class="sd">        width : int, optional</span>
<span class="sd">            Edge width in pixels.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        edge display property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span></div>
</div>



<span class="k">class</span> <span class="nc">_TetrahedralMesh</span><span class="p">(</span><span class="n">Prop</span><span class="p">,</span> <span class="n">PropertyMixin</span><span class="p">,</span> <span class="n">MapperMixin</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">tets</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkUnstructuredGrid</span><span class="p">):</span>
            <span class="k">assert</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_usgrid</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkUnstructuredGrid</span><span class="p">()</span>

            <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
            <span class="n">points</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">numpy_to_vtk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_usgrid</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_usgrid</span><span class="o">.</span><span class="n">Allocate</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tets</span><span class="p">))</span>

            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_usgrid</span>

            <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tets</span><span class="p">))</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tets</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tets</span><span class="p">):</span>
                <span class="n">tetra</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkIdList</span><span class="p">()</span>

                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>

                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tet</span><span class="p">:</span>
                    <span class="n">tetra</span><span class="o">.</span><span class="n">InsertNextId</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

                <span class="n">grid</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">VTK_TETRA</span><span class="p">,</span> <span class="n">tetra</span><span class="p">)</span>
                <span class="c1"># break</span>

                <span class="c1"># if i &gt; 100:</span>
                <span class="c1">#     break</span>

        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkDataSetMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk_usgrid</span><span class="p">)</span>

        <span class="c1"># Create standard lookup table and how this table is used by</span>
        <span class="c1"># the mapper.</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">_generic_lut</span><span class="p">(</span><span class="n">gradient</span><span class="o">=</span><span class="s1">&#39;spectral&#39;</span><span class="p">))</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetUseLookupTableScalarRange</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetScalarVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>

        <span class="c1"># Initialize Prop base class. Mixins don&#39;t have an initializer.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Edge display.</span>

<span class="sd">        Set visual properties of edges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        style : str, optional</span>
<span class="sd">            Either &#39;lines&#39; or &#39;tubes&#39;, :obj:`False` to disable.</span>
<span class="sd">        width : int, optional</span>
<span class="sd">            Edge width in pixels.</span>
<span class="sd">        color : array_like, shape (3, ), optional</span>
<span class="sd">            Edge color.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Parameters with a :obj:`None` value do not affect the corresponding</span>
<span class="sd">        edge display property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;tubes&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetRenderLinesAsTubes</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">style</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeVisibility</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vtk_prop</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetEdgeColor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>


<div class="viewcode-block" id="LookupTable">
<a class="viewcode-back" href="../../api/m3sh.vis.LookupTable.html#m3sh.vis.LookupTable">[docs]</a>
<span class="k">class</span> <span class="nc">LookupTable</span><span class="p">(</span><span class="n">Prop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Color bar.</span>

<span class="sd">    Visual representation of a lookup table associated with a displayed</span>
<span class="sd">    shape.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    actor : Prop or vtkActor</span>
<span class="sd">        A render object.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The wrapped actor is a 2-dimensional actor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actor</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">actor</span><span class="p">,</span> <span class="n">Prop</span><span class="p">):</span>
            <span class="n">actor</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">prop</span>

        <span class="n">lut</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span><span class="o">.</span><span class="n">GetLookupTable</span><span class="p">()</span>

        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkScalarBarActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetDrawBelowRangeSwatch</span><span class="p">(</span><span class="n">lut</span><span class="o">.</span><span class="n">GetUseBelowRangeColor</span><span class="p">())</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetDrawAboveRangeSwatch</span><span class="p">(</span><span class="n">lut</span><span class="o">.</span><span class="n">GetUseAboveRangeColor</span><span class="p">())</span>

        <span class="n">actor</span><span class="o">.</span><span class="n">SetNumberOfLabels</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetBarRatio</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMaximumWidthInPixels</span><span class="p">(</span><span class="mi">180</span><span class="p">)</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">GetLabelTextProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetFontSize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetUnconstrainedFontSize</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">lut</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Position property.</span>

<span class="sd">        Location of the lower left corner in normalized screen</span>
<span class="sd">        coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">()</span>

    <span class="nd">@position</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prop</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

        <span class="c1"># self.prop.Modified()</span>

    <span class="c1"># def _modified(self, object=None):</span>
    <span class="c1">#     &quot;&quot;&quot; Update representation.</span>

    <span class="c1">#     Update lookup table representation from `object`.</span>

    <span class="c1">#     Parameters</span>
    <span class="c1">#     ----------</span>
    <span class="c1">#     object : Shape, optional</span>
    <span class="c1">#         Polygonal shape instance.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if object is None:</span>
    <span class="c1">#         lut = self.prop.GetLookupTable()</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             actor = object.actor</span>
    <span class="c1">#         except AttributeError:</span>
    <span class="c1">#             actor = object</span>

    <span class="c1">#         lut = actor.GetMapper().GetLookupTable()</span>
    <span class="c1">#         self.actor.SetLookupTable(lut)</span>

    <span class="c1">#     self.actor.SetDrawBelowRangeSwatch(lut.GetUseBelowRangeColor())</span>
    <span class="c1">#     self.actor.SetDrawAboveRangeSwatch(lut.GetUseAboveRangeColor())</span>


<span class="c1"># class RenderMesh(RenderObject):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     &quot;&quot;&quot;</span>

<span class="c1">#     def __init__(self, obj, cpts=None):</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         super().__init__(obj)</span>

<span class="c1">#         self._cpts = cpts</span>
<span class="c1">#         self._usecpts = False</span>

<span class="c1">#     @RenderObject.pickable.setter</span>
<span class="c1">#     def pickable(self, value):</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         if self._usecpts:</span>
<span class="c1">#             self._cpts.SetPickable(bool(value))</span>
<span class="c1">#         else:</span>
<span class="c1">#             self._actor.SetPickable(bool(value))</span>

<span class="c1">#     @property</span>
<span class="c1">#     def usecpts(self):</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         return self._usecpts</span>

<span class="c1">#     @usecpts.setter</span>
<span class="c1">#     def usecpts(self, value):</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         if self._cpts is not None:</span>
<span class="c1">#             self._usecpts = bool(value)</span>

<span class="c1">#             if self._usecpts:</span>
<span class="c1">#                 self._cpts.SetPickable(self._actor.GetPickable())</span>
<span class="c1">#                 self._actor.SetPickable(False)</span>
<span class="c1">#             else:</span>
<span class="c1">#                 self._actor.SetPickable(self._cpts.GetPickable())</span>
<span class="c1">#                 self._cpts.SetPickable(False)</span>


<span class="k">class</span> <span class="nc">_MouseInteractorStyle</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkInteractorStyleTrackballCamera</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Trackball camera interactor style.</span>

<span class="sd">    Initialize state variables and register user defined callbacks for</span>
<span class="sd">    mouse and keyboard events.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lmbdown : list[callable]</span>
<span class="sd">        Left button press callbacks.</span>
<span class="sd">    lmbup : list[callable]</span>
<span class="sd">        Left button release callbacks.</span>
<span class="sd">    rmbdown : list[callable]</span>
<span class="sd">        Right button press callbacks.</span>
<span class="sd">    rmbup : list[callable]</span>
<span class="sd">        Right button release callbacks.</span>
<span class="sd">    keydown : list[callable]</span>
<span class="sd">        Key press callbacks.</span>
<span class="sd">    keyup : list[callable]</span>
<span class="sd">        Key release callbacks.</span>
<span class="sd">    mousemove : list[callable]</span>
<span class="sd">        Mouse move callbacks.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    Multiple callbacks for the same type of event are invoked in the</span>
<span class="sd">    specified order. See :py:func:`show` for an example on how to define</span>
<span class="sd">    and use callback functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lmbdown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lmbup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">rmbdown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rmbup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">keydown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keyup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mousemove</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># User defined callbacks. Those callbacks are invoked in the order</span>
        <span class="c1"># they were passed.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lmb_down_cbs</span> <span class="o">=</span> <span class="n">lmbdown</span> <span class="k">if</span> <span class="n">lmbdown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_down_cbs</span> <span class="o">=</span> <span class="n">rmbdown</span> <span class="k">if</span> <span class="n">rmbdown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_down_cbs</span> <span class="o">=</span> <span class="n">keydown</span> <span class="k">if</span> <span class="n">keydown</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_lmb_up_cbs</span> <span class="o">=</span> <span class="n">lmbup</span> <span class="k">if</span> <span class="n">lmbup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_up_cbs</span> <span class="o">=</span> <span class="n">rmbup</span> <span class="k">if</span> <span class="n">rmbup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_up_cbs</span> <span class="o">=</span> <span class="n">keyup</span> <span class="k">if</span> <span class="n">keyup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_mouse_move_cbs</span> <span class="o">=</span> <span class="n">mousemove</span> <span class="k">if</span> <span class="n">mousemove</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="c1"># See the vtkCommand class documentation for an enumeration of all</span>
        <span class="c1"># available events and their names.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;LeftButtonPressEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lmb_down_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;LeftButtonReleaseEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lmb_up_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;RightButtonPressEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_down_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;RightButtonReleaseEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_up_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;KeyPressEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_press_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;KeyReleaseEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_release_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;MouseMoveEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mouse_move_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;InteractionEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interaction_event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s2">&quot;CharEvent&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_char_event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Display to world coordinate projection.</span>

<span class="sd">        Helper function mainly used during vertex dragging. Relies on the</span>
<span class="sd">        value of :py:attr:`_picked_fac`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ren : vtkRenderer</span>
<span class="sd">            The affected renderer or viewport.</span>
<span class="sd">        x : int</span>
<span class="sd">            Display x-coordinate.</span>
<span class="sd">        y : int</span>
<span class="sd">            Display y-coordinate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            World coordinates of the mapped point.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Display coordinates are given in pixels and determine a point in the</span>
<span class="sd">        active render window.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Convert from display to world coordinates. Pixel coordinates are</span>
        <span class="c1"># transformed to 3D world coordinates of the corresponding point on</span>
        <span class="c1"># the image plane.</span>
        <span class="n">p2d</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCoordinate</span><span class="p">()</span>
        <span class="n">p2d</span><span class="o">.</span><span class="n">SetCoordinateSystemToDisplay</span><span class="p">()</span>
        <span class="n">p2d</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">p2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p2d</span><span class="o">.</span><span class="n">GetComputedWorldValue</span><span class="p">(</span><span class="n">ren</span><span class="p">))</span>

        <span class="c1"># Now apply the intercept theorem. Need the eye position for that.</span>
        <span class="c1"># If the scale factor is 1.0 the coordinates of the corresponding</span>
        <span class="c1"># point on the image plane are returned.</span>
        <span class="n">eye</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ren</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">()</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">eye</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_picked_fac</span><span class="o">*</span><span class="p">(</span><span class="n">p2d</span><span class="o">-</span><span class="n">eye</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_lmb_down_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; LMB down event handler.</span>

<span class="sd">        Dispatches left mouse button press events to user defined callbacks.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as ``self``.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: ``&#39;LeftButtonPressEvent&#39;``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get corresponding render window interactor and event location</span>
        <span class="c1"># in window coordinates.</span>
        <span class="n">iren</span> <span class="o">=</span> <span class="n">irenstyle</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetEventPosition</span><span class="p">()</span>

        <span class="c1"># Broadcast the event to all user defined callbacks.</span>
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lmb_down_cbs</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

        <span class="c1"># Forward event to the standard event handler. Without this call</span>
        <span class="c1"># the scene cannot be rotated.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OnLeftButtonDown</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_lmb_up_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; LMB up event handler.</span>

<span class="sd">        Dispatch left mouse button release events to user defined callbacks.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as ``self``.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: ``&#39;LeftButtonReleaseEvent&#39;``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get corresponding render window interactor and event location</span>
        <span class="c1"># in window coordinates.</span>
        <span class="n">iren</span> <span class="o">=</span> <span class="n">irenstyle</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetEventPosition</span><span class="p">()</span>

        <span class="c1"># Broadcast the event to all user defined callbacks.</span>
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lmb_up_cbs</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

        <span class="c1"># Hand off to standard event handler. Without this call we are</span>
        <span class="c1"># stuck in scene rotation mode.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OnLeftButtonUp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_rmb_down_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; RMB down event handler.</span>

<span class="sd">        Dispatch to user defined event callbacks. On a successful point pick</span>
<span class="sd">        action the interactor style changes to vertex dragging. This stops</span>
<span class="sd">        once the right mouse button is released.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as ``self``.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: ``&#39;RightButtonPressEvent&#39;``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get corresponding render window interactor, viewport and event</span>
        <span class="c1"># location in window coordinates.</span>
        <span class="n">iren</span> <span class="o">=</span> <span class="n">irenstyle</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetEventPosition</span><span class="p">()</span>

        <span class="c1"># Broadcast the event to all user defined callbacks.</span>
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_down_cbs</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

        <span class="c1"># Forward events to the standard event handler. Without this call</span>
        <span class="c1"># zooming with the right mouse button is diabled.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OnRightButtonDown</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_rmb_up_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; RMB up event handler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as ``self``.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: ``&#39;RightButtonReleaseEvent&#39;``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get corresponding render window interactor and event location</span>
        <span class="c1"># in window coordinates.</span>
        <span class="n">iren</span> <span class="o">=</span> <span class="n">irenstyle</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetEventPosition</span><span class="p">()</span>

        <span class="c1"># Broadcast the event to all user defined callbacks.</span>
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_up_cbs</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

        <span class="c1"># Hand off to the standard event handler. Without this call we</span>
        <span class="c1"># are stuck in zoom mode.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OnRightButtonUp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_mouse_move_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Mouse move event observer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as `self`.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: &#39;MouseMoveEvent&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get corresponding render window interactor, viewport and event</span>
        <span class="c1"># location in window coordinates.</span>
        <span class="n">iren</span> <span class="o">=</span> <span class="n">irenstyle</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetEventPosition</span><span class="p">()</span>

        <span class="c1"># Get the affected viewport to synchronize the axes widget to the</span>
        <span class="c1"># current camera.</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">FindPokedRenderer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># Make the axes widget jump to the active viewport. While the</span>
        <span class="c1"># orientation marker widget placement is relative to the renderer,</span>
        <span class="c1"># the camera orientation widget can only be placed in one of the</span>
        <span class="c1"># corners of the render window.</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">GetParentRenderer</span><span class="p">()</span>
            <span class="n">setren</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">SetParentRenderer</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">GetCurrentRenderer</span><span class="p">()</span>
            <span class="n">setren</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">SetCurrentRenderer</span>

        <span class="c1"># Set parent (or current) renderer and request render pass for</span>
        <span class="c1"># the changes to take effect.</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ren</span><span class="p">:</span>
            <span class="n">setren</span><span class="p">(</span><span class="n">ren</span><span class="p">)</span>
            <span class="n">iren</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>

        <span class="c1"># Broadcast the event to all user defined callbacks.</span>
        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mouse_move_cbs</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

        <span class="c1"># Hand off to the standard event handler.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OnMouseMove</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_key_press_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Key press event observer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as `self`.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: &#39;KeyPressEvent&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">iren</span> <span class="o">=</span> <span class="n">irenstyle</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetEventPosition</span><span class="p">()</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetKeySym</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
            <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">SetEnabled</span><span class="p">(</span><span class="ow">not</span> <span class="n">iren</span><span class="o">.</span><span class="n">axes_widget</span><span class="o">.</span><span class="n">GetEnabled</span><span class="p">())</span>
            <span class="n">iren</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span>
            <span class="n">_commands</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_down_cbs</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">OnKeyPress</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_key_release_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Key release event observer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as `self`.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: &#39;KeyReleaseEvent&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">iren</span> <span class="o">=</span> <span class="n">irenstyle</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">GetEventPosition</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_up_cbs</span><span class="p">:</span>
            <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">OnKeyRelease</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_char_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Character event observer.</span>

<span class="sd">        Any button press qualifies as a character event (including</span>
<span class="sd">        modifier keys). Character events trigger window rendering.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as `self`.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: &#39;CharEvent&#39;.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        This observer can be used to disable all default interactor</span>
<span class="sd">        keyboard commands.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Keypresses typically invoke some computation. Start render pass</span>
        <span class="c1"># to update the scene.</span>
        <span class="k">for</span> <span class="n">iren</span> <span class="ow">in</span> <span class="n">_interactors</span><span class="p">:</span>
            <span class="n">iren</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>

        <span class="c1"># Uncomment this line to enable all default commands of the</span>
        <span class="c1"># interactor, like &#39;q&#39; for quit and &#39;w&#39; for wireframe rendering.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OnChar</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_interaction_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">irenstyle</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Interaction event observer.</span>

<span class="sd">        Dragging the mouse (moving the cursor while holding down a mouse</span>
<span class="sd">        button) qualifies as an interaction event.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        irenstyle : vtkInteractorStyle</span>
<span class="sd">            The corresponding interactor style, same as `self`.</span>
<span class="sd">        event : str</span>
<span class="sd">            String identifier of the event: &#39;InteractionEvent&#39;.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Interaction events trigger a window rendering pass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Synchronize windows in case some of their renderers share a</span>
        <span class="c1"># camera (otherwise windows would first get updated once they</span>
        <span class="c1"># get back mouse focus). This is purely cosmetic!</span>
        <span class="c1"># for iren in _interactors:</span>
        <span class="c1">#     iren.Render()</span>


<span class="k">class</span> <span class="nc">_VertexDragger</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">initiate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">FindPokedRenderer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># If we are not already vertex dragging we start vertex dragging.</span>
        <span class="c1"># There cannot be a right button press event in this state.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_active</span><span class="p">:</span>
            <span class="c1"># A point picker will pick points of the underlying point set</span>
            <span class="c1"># of a data set even if those points not part of any cell.</span>
            <span class="c1">#picker = vtk.vtkPointPicker()</span>
            <span class="n">picker</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellPicker</span><span class="p">()</span>
            <span class="c1"># picker.SetTolerance(0.005)</span>
            <span class="n">picker</span><span class="o">.</span><span class="n">Pick</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ren</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">GetActor</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Check if we may drag the picked point. If the attribute is</span>
                <span class="c1"># not present all points can be dragged.</span>
                <span class="n">pid</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">GetPointId</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">draggable</span> <span class="o">=</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">draggable_points</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">draggable</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">draggable</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="k">if</span> <span class="n">draggable</span><span class="p">:</span>
                    <span class="c1"># The picked point set is reachable by the picked actor&#39;s</span>
                    <span class="c1"># mapper object.</span>
                    <span class="n">mapper</span> <span class="o">=</span> <span class="n">picker</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span>

                    <span class="c1"># Enter vertex dragging state. Store all information as</span>
                    <span class="c1"># attributes of the interactor style object.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_vertex_drag</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_picked_obj</span> <span class="o">=</span> <span class="n">obj</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_picked_pts</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span>

                    <span class="n">p2d</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCoordinate</span><span class="p">()</span>
                    <span class="n">p2d</span><span class="o">.</span><span class="n">SetCoordinateSystemToDisplay</span><span class="p">()</span>
                    <span class="n">p2d</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
                    <span class="n">p2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p2d</span><span class="o">.</span><span class="n">GetComputedWorldValue</span><span class="p">(</span><span class="n">ren</span><span class="p">))</span>
                    <span class="n">p3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">picker</span><span class="o">.</span><span class="n">GetPickPosition</span><span class="p">())</span>

                    <span class="c1"># Eye point position and scale factor derived from the</span>
                    <span class="c1"># intercept thoerem.</span>
                    <span class="n">eye</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ren</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">()</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">())</span>
                    <span class="n">fac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p3d</span><span class="o">-</span><span class="n">eye</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p2d</span><span class="o">-</span><span class="n">eye</span><span class="p">)</span>

                    <span class="c1"># World space coordinates of the point on the image</span>
                    <span class="c1"># plane and of the picked point.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_picked_p2d</span> <span class="o">=</span> <span class="n">p2d</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_picked_p3d</span> <span class="o">=</span> <span class="n">p3d</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_picked_pid</span> <span class="o">=</span> <span class="n">pid</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_picked_fac</span> <span class="o">=</span> <span class="n">fac</span>

                    <span class="c1"># Broadcast the event to all user defined callbacks.</span>
                    <span class="c1"># Pass extra vertex dragging related keyword arguments.</span>
                    <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_down_cbs</span><span class="p">:</span>
                        <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
                                                    <span class="n">pid</span><span class="o">=</span><span class="n">pid</span><span class="p">,</span>
                                                    <span class="n">p3d</span><span class="o">=</span><span class="n">p3d</span><span class="p">)</span>

                    <span class="c1"># Do not execute standard event handlers. This would</span>
                    <span class="c1"># interfere with vertex dragging behavior.</span>
                    <span class="k">return</span>

            <span class="c1"># Broadcast the event to all user defined callbacks. This path</span>
            <span class="c1"># is taken if nothing was picked.</span>
            <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_down_cbs</span><span class="p">:</span>
                <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

            <span class="c1"># Forward events to the standard event handlers when we are not</span>
            <span class="c1"># in vertex drag mode.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OnRightButtonDown</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This point should never be reached! If it happens events were</span>
            <span class="c1"># received from the window system in asynchronous order.</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Right mouse button press event received before &#39;</span> <span class="o">+</span>
                   <span class="s1">&#39;it was released!&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">drag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">FindPokedRenderer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># Update the position of actively dragged points on mouse movement.</span>
        <span class="c1"># We are in this state as long as the right mouse button is down.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_active</span><span class="p">:</span>
            <span class="n">p3d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project</span><span class="p">(</span><span class="n">ren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_picked_pid</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_picked_obj</span>

            <span class="c1"># An actor can provide a project method. This method acts as a</span>
            <span class="c1"># constraint during point dragging.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">p3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">ren</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">p3d</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="c1"># Update point location of the point in the corresponding</span>
            <span class="c1"># point set. Calling .Modified() seems not enough to update the</span>
            <span class="c1"># render window.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_picked_pts</span><span class="o">.</span><span class="n">SetPoint</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">p3d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p3d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p3d</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_picked_pts</span><span class="o">.</span><span class="n">Modified</span><span class="p">()</span>

            <span class="c1"># Nudge for render window update...</span>
            <span class="n">ren</span><span class="o">.</span><span class="n">GetRenderWindow</span><span class="p">()</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>

            <span class="c1"># Broadcast the event to all user defined callbacks. Pass extra</span>
            <span class="c1"># keyword argument during vertex dragging.</span>
            <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mouse_move_cbs</span><span class="p">:</span>
                <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                   <span class="n">event</span><span class="o">=</span><span class="s1">&#39;MouseDragEvent&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">pid</span><span class="o">=</span><span class="n">pid</span><span class="p">,</span> <span class="n">p3d</span><span class="o">=</span><span class="n">p3d</span><span class="p">)</span>

            <span class="c1"># Invoke the modified event. Pass the id of the modified point</span>
            <span class="c1"># as additinal callback data. In order to receive that data the</span>
            <span class="c1"># callback needs to use a corresponding decorator, e.g.</span>
            <span class="c1"># @vtk.calldata_type(vtk.VTK_INT) to pass integers as data.</span>
            <span class="c1"># self._picked_obj.Modified()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_picked_obj</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="s1">&#39;ModifiedEvent&#39;</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>

            <span class="c1"># Do not execute standard event handlers. They interfere with</span>
            <span class="c1"># vertex dragging behavior.</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Broadcast the event to all user defined callbacks. No extra</span>
            <span class="c1"># argument except event identifier.</span>
            <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mouse_move_cbs</span><span class="p">:</span>
                <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="n">iren</span><span class="o">.</span><span class="n">FindPokedRenderer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># This is the final update of the position of actively dragged points</span>
        <span class="c1"># on mouse movement.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vertex_drag</span><span class="p">:</span>
            <span class="n">p3d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project</span><span class="p">(</span><span class="n">ren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_picked_pid</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_picked_obj</span>

            <span class="c1"># An actor can provide a project method. This method acts as a</span>
            <span class="c1"># constraint during point dragging.</span>
            <span class="c1"># try:</span>
            <span class="c1">#     p3d = np.asarray(obj.project(ren, pid, p3d))</span>
            <span class="c1"># except AttributeError:</span>
            <span class="c1">#     pass</span>

            <span class="c1"># Update point location of the point in the corresponding point</span>
            <span class="c1"># set. Call .Modified() to queue render window update.</span>
            <span class="c1"># self._picked_pts.SetPoint(pid, p3d[0], p3d[1], p3d[2])</span>
            <span class="c1"># self._picked_pts.Modified()</span>

            <span class="c1"># Calling .Modified is not always enough. Nudge...</span>
            <span class="n">ren</span><span class="o">.</span><span class="n">GetRenderWindow</span><span class="p">()</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>

            <span class="c1"># Broadcast the event to all user defined callbacks with extra</span>
            <span class="c1"># vertex dragging keyword arguments.</span>
            <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_up_cbs</span><span class="p">:</span>
                <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                   <span class="n">event</span><span class="o">=</span><span class="s1">&#39;MouseDragEnd&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">pid</span><span class="o">=</span><span class="n">pid</span><span class="p">,</span> <span class="n">p3d</span><span class="o">=</span><span class="n">p3d</span><span class="p">)</span>

            <span class="c1"># Invoke the modified event. Pass the id of the modified point</span>
            <span class="c1"># as additinal callback data. In order to receive that data the</span>
            <span class="c1"># callback needs to use a corresponding decorator, e.g.</span>
            <span class="c1"># @vtk.calldata_type(vtk.VTK_INT) to pass integers as data.</span>
            <span class="c1"># self._picked_obj.InvokeEvent(&#39;ModifiedEvent&#39;, pid)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Broadcast the event to all user defined callbacks. No extra</span>
            <span class="c1"># keyword arguments.</span>
            <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rmb_up_cbs</span><span class="p">:</span>
                <span class="n">cb</span><span class="p">(</span><span class="n">iren</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>

        <span class="c1"># Leave vertex dragging mode and hand off to standard event handlers.</span>
        <span class="c1"># Reset the scale factor. The _project method will now map 2D window</span>
        <span class="c1"># coordinates to 3D image plane point coordinates.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vertex_drag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_picked_obj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_picked_fac</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">_main</span><span class="p">()</span>
    <span class="c1"># _test()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, m3shware.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>